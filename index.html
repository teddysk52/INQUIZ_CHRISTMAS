<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>INQUIZ üéÑ V√°noƒçn√≠ Speci√°l</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(180deg, #0a1628 0%, #1a2a4a 100%);
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
        }

        /* –°–Ω–µ–∂–∏–Ω–∫–∏ */
        .snowflakes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            overflow: hidden;
        }

        .snowflake {
            position: absolute;
            top: -20px;
            color: #fff;
            font-size: 1rem;
            animation: fall linear infinite;
            opacity: 0.8;
        }

        @keyframes fall {
            0% { transform: translateY(-20px) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }

        /* –ì–∏—Ä–ª—è–Ω–¥–∞ */
        .garland {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 25px;
            display: flex;
            justify-content: space-around;
            z-index: 999;
            background: linear-gradient(180deg, rgba(0,50,0,0.8) 0%, transparent 100%);
        }

        .light {
            width: 12px;
            height: 18px;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            animation: glow 1.5s infinite;
        }

        @keyframes glow {
            0%, 100% { opacity: 1; filter: brightness(1.5) drop-shadow(0 0 8px currentColor); }
            50% { opacity: 0.6; }
        }

        .light:nth-child(5n+1) { background: #ff3333; color: #ff3333; animation-delay: 0s; }
        .light:nth-child(5n+2) { background: #33ff33; color: #33ff33; animation-delay: 0.3s; }
        .light:nth-child(5n+3) { background: #ffdd33; color: #ffdd33; animation-delay: 0.6s; }
        .light:nth-child(5n+4) { background: #3366ff; color: #3366ff; animation-delay: 0.9s; }
        .light:nth-child(5n+5) { background: #ff33ff; color: #ff33ff; animation-delay: 1.2s; }

        /* ===== –≠–ö–†–ê–ù–´ ===== */
        .screen {
            display: none;
            min-height: 100vh;
        }
        .screen.active {
            display: flex;
            flex-direction: column;
        }

        /* ===== –õ–û–ë–ë–ò ===== */
        .lobby {
            align-items: center;
            justify-content: center;
            padding: 50px 20px;
            text-align: center;
        }

        .lobby h1 {
            font-size: 3.5rem;
            color: #ffd700;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(255,215,0,0.5);
        }

        .lobby h2 {
            font-size: 1.5rem;
            color: rgba(255,255,255,0.7);
            margin-bottom: 40px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-field {
            width: 100%;
            max-width: 400px;
            padding: 18px 25px;
            font-size: 1.2rem;
            text-align: center;
            background: rgba(255,255,255,0.1);
            border: 3px solid #ffd700;
            border-radius: 15px;
            color: #fff;
            font-weight: 600;
            outline: none;
        }

        .input-field::placeholder {
            color: rgba(255,255,255,0.5);
        }

        .btn {
            padding: 18px 50px;
            font-size: 1.2rem;
            font-weight: 700;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px;
        }

        .btn-primary {
            background: linear-gradient(145deg, #22c55e, #16a34a);
            color: #fff;
            box-shadow: 0 8px 25px rgba(34,197,94,0.4);
        }

        .btn-danger {
            background: linear-gradient(145deg, #ef4444, #dc2626);
            color: #fff;
            border: 3px solid #ffd700;
            box-shadow: 0 8px 25px rgba(239,68,68,0.4);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #ef4444;
            border: 2px solid #ef4444;
        }

        .btn:hover {
            transform: translateY(-3px);
        }

        .teams-box {
            margin: 30px 0;
            width: 100%;
            max-width: 500px;
        }

        .teams-title {
            color: rgba(255,255,255,0.7);
            margin-bottom: 15px;
        }

        .team-item {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 15px 25px;
            margin: 8px 0;
            font-size: 1.2rem;
            font-weight: 600;
            color: #ffd700;
        }

        .team-item.my-team {
            border-color: #22c55e;
            background: rgba(34,197,94,0.2);
        }

        .password-box {
            margin-top: 40px;
        }

        .password-field {
            width: 200px;
            padding: 15px;
            font-size: 1.5rem;
            text-align: center;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 15px;
            color: #fff;
            font-weight: 600;
            letter-spacing: 5px;
            margin-bottom: 20px;
        }

        /* ===== –ó–ê–°–¢–ê–í–ö–ê –†–ê–£–ù–î–ê ===== */
        .intro {
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .intro-title {
            font-size: 4rem;
            font-weight: 900;
            color: #ffd700;
            margin-bottom: 40px;
            text-shadow: 0 0 40px rgba(255,215,0,0.6);
        }

        .themes-list {
            max-width: 700px;
            width: 100%;
        }

        .theme-item {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 18px 25px;
            margin-bottom: 12px;
            font-size: 1.4rem;
            font-weight: 700;
            opacity: 0;
            transform: translateY(20px);
            animation: slideUp 0.5s forwards;
        }

        @keyframes slideUp {
            to { opacity: 1; transform: translateY(0); }
        }

        .theme-item:nth-child(1) { animation-delay: 0.3s; }
        .theme-item:nth-child(2) { animation-delay: 0.5s; }
        .theme-item:nth-child(3) { animation-delay: 0.7s; }
        .theme-item:nth-child(4) { animation-delay: 0.9s; }
        .theme-item:nth-child(5) { animation-delay: 1.1s; }

        /* ===== –ò–ì–†–ê ===== */
        .game {
            padding: 40px 15px 20px;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 2.5rem;
            color: #ffd700;
        }

        .round-badge {
            display: inline-block;
            background: linear-gradient(145deg, #c41e3a, #8b0000);
            padding: 8px 25px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: 700;
            margin-top: 10px;
        }

        /* –¢–∞–±–ª–æ */
        .scoreboard {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .team-score {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 12px 20px;
            text-align: center;
            min-width: 120px;
            transition: all 0.3s;
        }

        .team-score.my-team {
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255,215,0,0.3);
        }

        .team-score.answering {
            border-color: #22c55e;
            background: rgba(34,197,94,0.2);
            animation: pulse 0.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .team-score .name {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
            margin-bottom: 5px;
        }

        .team-score .score {
            font-size: 1.8rem;
            font-weight: 900;
            color: #ffd700;
        }

        /* –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ */
        .board {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
        }

        .category {
            background: linear-gradient(145deg, #c41e3a, #8b0000);
            padding: 15px 8px;
            text-align: center;
            border-radius: 10px;
            font-weight: 700;
            font-size: 0.75rem;
            text-transform: uppercase;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cell {
            background: linear-gradient(145deg, #1e5128, #2d7a3a);
            border: 2px solid rgba(255,255,255,0.1);
            padding: 20px;
            text-align: center;
            border-radius: 10px;
            font-weight: 900;
            font-size: 1.3rem;
            color: #ffd700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .cell:hover:not(.used) {
            transform: scale(1.05);
            border-color: #ffd700;
        }

        .cell.used {
            background: rgba(50,50,50,0.5);
            color: rgba(255,255,255,0.2);
            cursor: not-allowed;
        }

        /* ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(145deg, #1a2a4a, #0a1628);
            border: 3px solid rgba(255,215,0,0.3);
            border-radius: 25px;
            padding: 40px;
            max-width: 900px;
            width: 100%;
            text-align: center;
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            color: #fff;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .close-btn:hover {
            background: rgba(239,68,68,0.3);
            border-color: #ef4444;
        }

        .modal-cat {
            font-size: 0.9rem;
            color: rgba(255,255,255,0.6);
            text-transform: uppercase;
            margin-bottom: 10px;
        }

        .modal-pts {
            font-size: 4rem;
            font-weight: 900;
            color: #ffd700;
            margin-bottom: 15px;
        }

        .timer {
            font-size: 3.5rem;
            font-weight: 900;
            color: #4ade80;
            margin-bottom: 20px;
        }

        .timer.warning { color: #fbbf24; }
        .timer.danger { color: #ef4444; animation: blink 0.5s infinite; }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .modal-q {
            font-size: 1.8rem;
            line-height: 1.5;
            margin-bottom: 30px;
        }

        .answering-info {
            font-size: 1.3rem;
            color: rgba(255,255,255,0.7);
            margin-bottom: 20px;
        }

        .answering-info .team {
            color: #ffd700;
            font-weight: 900;
        }

        .buzz-btn {
            width: 180px;
            height: 180px;
            background: linear-gradient(145deg, #ef4444, #dc2626);
            border: 5px solid #ffd700;
            border-radius: 50%;
            font-size: 1.3rem;
            font-weight: 900;
            color: #fff;
            cursor: pointer;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(239,68,68,0.4);
            transition: all 0.3s;
        }

        .buzz-btn:hover:not(.disabled) {
            transform: scale(1.1);
        }

        .buzz-btn.disabled {
            background: rgba(100,100,100,0.5);
            border-color: rgba(255,255,255,0.2);
            cursor: not-allowed;
        }

        .answer-box {
            display: none;
            margin-top: 20px;
        }

        .answer-box.active {
            display: block;
        }

        .answer-input {
            width: 100%;
            max-width: 450px;
            padding: 18px;
            font-size: 1.4rem;
            text-align: center;
            background: rgba(255,255,255,0.1);
            border: 3px solid #ffd700;
            border-radius: 15px;
            color: #fff;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .result {
            font-size: 2rem;
            font-weight: 900;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            display: none;
        }

        .result.correct {
            display: block;
            background: rgba(34,197,94,0.2);
            border: 3px solid #22c55e;
            color: #22c55e;
        }

        .result.wrong {
            display: block;
            background: rgba(239,68,68,0.2);
            border: 3px solid #ef4444;
            color: #ef4444;
        }

        .correct-answer {
            margin-top: 20px;
            padding: 15px;
            background: rgba(74,222,128,0.1);
            border-radius: 10px;
            color: #4ade80;
            font-size: 1.2rem;
        }

        /* –ê–¥–º–∏–Ω –∫–Ω–æ–ø–∫–∞ */
        .admin-btn {
            position: fixed;
            top: 35px;
            right: 15px;
            width: 45px;
            height: 45px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            color: #fff;
            font-size: 1.3rem;
            cursor: pointer;
            z-index: 1001;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .lobby h1 { font-size: 2.5rem; }
            .intro-title { font-size: 2.5rem; }
            .theme-item { font-size: 1.1rem; padding: 14px 20px; }
            .board { gap: 5px; }
            .category { font-size: 0.6rem; padding: 10px 5px; min-height: 55px; }
            .cell { padding: 12px 8px; font-size: 1rem; }
            .modal-content { padding: 25px 15px; }
            .modal-q { font-size: 1.3rem; }
            .modal-pts { font-size: 3rem; }
            .timer { font-size: 2.5rem; }
            .buzz-btn { width: 140px; height: 140px; font-size: 1rem; }
            .team-score { min-width: 90px; padding: 10px 12px; }
            .team-score .score { font-size: 1.4rem; }
        }
    </style>
</head>
<body>
    <!-- –ì–∏—Ä–ª—è–Ω–¥–∞ -->
    <div class="garland" id="garland"></div>
    
    <!-- –°–Ω–µ–∂–∏–Ω–∫–∏ -->
    <div class="snowflakes" id="snowflakes"></div>

    <!-- –ê–¥–º–∏–Ω –∫–Ω–æ–ø–∫–∞ -->
    <button class="admin-btn" onclick="adminPanel()">‚öôÔ∏è</button>

    <!-- ===== –õ–û–ë–ë–ò ===== -->
    <div class="screen lobby" id="lobbyScreen">
        <h1>üéÑ INQUIZ üéÑ</h1>
        <h2>V√°noƒçn√≠ Speci√°l ‚ùÑÔ∏è</h2>
        
        <div class="input-group">
            <input type="text" class="input-field" id="teamInput" placeholder="N√°zev va≈°eho t√Ωmu..." maxlength="20">
        </div>
        <button class="btn btn-primary" onclick="joinTeam()">‚ûï P≈ôidat t√Ωm</button>
        
        <div class="teams-box">
            <div class="teams-title">T√Ωmy v lobby:</div>
            <div id="teamsList"></div>
        </div>
        
        <div class="password-box">
            <input type="password" class="password-field" id="passwordInput" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="4">
            <br>
            <button class="btn btn-danger" onclick="startGame()">üöÄ ZAƒå√çT HRU</button>
            <br><br>
            <button class="btn btn-secondary" onclick="clearTeams()">üóëÔ∏è Vymazat t√Ωmy</button>
        </div>
    </div>

    <!-- ===== –ó–ê–°–¢–ê–í–ö–ê –†–ê–£–ù–î–ê ===== -->
    <div class="screen intro" id="introScreen">
        <div class="intro-title" id="introTitle">KOLO 1</div>
        <div class="themes-list" id="themesList"></div>
    </div>

    <!-- ===== –ò–ì–†–ê ===== -->
    <div class="screen game" id="gameScreen">
        <div class="header">
            <h1>üéÑ INQUIZ üéÑ</h1>
            <div class="round-badge" id="roundBadge">KOLO 1</div>
        </div>
        
        <div class="scoreboard" id="scoreboard"></div>
        <div class="board" id="board"></div>
    </div>

    <!-- ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û ===== -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeQuestion()">‚úï</button>
            <div class="modal-cat" id="modalCat"></div>
            <div class="modal-pts" id="modalPts"></div>
            <div class="timer" id="timer">20</div>
            <div class="modal-q" id="modalQ"></div>
            
            <div class="answering-info" id="answeringInfo" style="display:none;">
                Odpov√≠d√°: <span class="team" id="answeringTeam"></span>
            </div>
            
            <button class="buzz-btn" id="buzzBtn" onclick="buzz()">üîî<br>ODPOVƒöDƒöT</button>
            
            <div class="answer-box" id="answerBox">
                <input type="text" class="answer-input" id="answerInput" placeholder="Va≈°e odpovƒõƒè...">
                <br>
                <button class="btn btn-primary" onclick="submitAnswer()">Odeslat</button>
            </div>
            
            <div class="result" id="result"></div>
            <div class="correct-answer" id="correctAnswer" style="display:none;"></div>
        </div>
    </div>

    <script>
        // ===== FIREBASE =====
        const firebaseConfig = {
            apiKey: "AIzaSyDwo2GKOXEDDs31kRfFCQLy_TcXRC2DF0",
            authDomain: "inquiz-a82e2.firebaseapp.com",
            databaseURL: "https://inquiz-a82e2-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "inquiz-a82e2",
            storageBucket: "inquiz-a82e2.firebasestorage.app",
            messagingSenderId: "943129879818",
            appId: "1:943129879818:web:366e32fe072182cd0d86f3"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const gameRef = db.ref('inquiz2');

        // ===== –í–û–ü–†–û–°–´ =====
        const questions = {
            1: {
                "Minecraft üéÆ": [
                    { q: "Jak se jmenuje hlavn√≠ boss v Minecraftu?", a: ["ender dragon", "enderdragon", "–¥—Ä–∞–∫–æ–Ω"] },
                    { q: "Kolik blok≈Ø obsidi√°nu pot≈ôebuje≈° na port√°l do Netheru?", a: ["10", "deset"] },
                    { q: "Jak se jmenuje dimenze s Endermany?", a: ["the end", "end", "—ç–Ω–¥"] },
                    { q: "ƒå√≠m ochoƒç√≠≈° vlka?", a: ["kost", "bone", "–∫–æ—Å—Ç—å"] },
                    { q: "V jak√©m roce vy≈°el Minecraft 1.0?", a: ["2011"] }
                ],
                "Programov√°n√≠ üíª": [
                    { q: "Jak se naz√Ωv√° chyba v k√≥du?", a: ["bug", "–±–∞–≥", "chyba"] },
                    { q: "Kter√Ω jazyk je pojmenov√°n po k√°vƒõ?", a: ["java", "–¥–∂–∞–≤–∞"] },
                    { q: "Co znamen√° HTML?", a: ["hypertext markup language"] },
                    { q: "Oper√°tor pro porovn√°n√≠ v Pythonu?", a: ["==", "rovn√° se"] },
                    { q: "Datov√° struktura LIFO?", a: ["stack", "z√°sobn√≠k", "—Å—Ç–µ–∫"] }
                ],
                "IT & Tech üñ•Ô∏è": [
                    { q: "Co znamen√° USB?", a: ["universal serial bus"] },
                    { q: "Kter√° spoleƒçnost vytvo≈ôila iPhone?", a: ["apple", "—ç–ø–ª"] },
                    { q: "Co je RAM?", a: ["operaƒçn√≠ pamƒõ≈•", "random access memory", "–ø–∞–º—è—Ç—å"] },
                    { q: "Kdy byl zalo≈æen Google?", a: ["1998"] },
                    { q: "Protokol pro bezpeƒçn√Ω p≈ôenos dat na webu?", a: ["https", "http"] }
                ],
                "Memes üòÇ": [
                    { q: "Jak se naz√Ωv√° vtipn√Ω obr√°zek na internetu?", a: ["meme", "–º–µ–º"] },
                    { q: "Slavn√Ω meme s koƒçkou u stolu se ≈æenou?", a: ["woman yelling at cat", "≈æena k≈ôiƒç√≠ na koƒçku"] },
                    { q: "Co je 'rickrolling'?", a: ["rick astley", "never gonna give you up", "rick"] },
                    { q: "Jak√© plemeno je pes z meme 'Doge'?", a: ["shiba", "shiba inu"] },
                    { q: "Co znamen√° LOL?", a: ["laughing out loud", "–ª–æ–ª"] }
                ],
                "V√°noce üéÑ": [
                    { q: "Jak se jmenuje sob s ƒçerven√Ωm nosem?", a: ["rudolf", "—Ä—É–¥–æ–ª—å—Ñ"] },
                    { q: "Z jak√© zemƒõ poch√°z√≠ tradice v√°noƒçn√≠ho stromku?", a: ["nƒõmecko", "germany", "–≥–µ—Ä–º–∞–Ω–∏—è"] },
                    { q: "V√°noƒçn√≠ n√°poj z ml√©ka a vajec?", a: ["eggnog", "—ç–≥–Ω–æ–≥", "vajeƒçn√Ω ko≈àak"] },
                    { q: "Kolik sob≈Ø t√°hne Santovy s√°nƒõ (bez Rudolfa)?", a: ["8", "osm"] },
                    { q: "Kalend√°≈ô s ok√©nky p≈ôed V√°nocemi?", a: ["adventn√≠ kalend√°≈ô", "advent", "adventn√≠"] }
                ]
            },
            2: {
                "Games üéÆ": [
                    { q: "Kter√° hra m√° mapu 'Dust 2'?", a: ["counter-strike", "cs", "csgo", "cs2", "counter strike"] },
                    { q: "Kde sb√≠r√°≈° V-Bucks?", a: ["fortnite", "—Ñ–æ—Ä–Ω–∞–π—Ç"] },
                    { q: "Hlavn√≠ postava s√©rie Witcher?", a: ["geralt", "–≥–µ—Ä–∞–ª—å—Ç", "–≤–µ–¥—å–º–∞–∫"] },
                    { q: "Hern√≠ engine od Epic Games?", a: ["unreal engine", "unreal"] },
                    { q: "Hra s zelen√Ωmi 'Creepery'?", a: ["minecraft"] }
                ],
                "≈†kola üìö": [
                    { q: "Kolik minut trv√° jedna ≈°koln√≠ hodina?", a: ["45", "ƒçty≈ôicet pƒõt"] },
                    { q: "Jak√° je nejhor≈°√≠ zn√°mka v ƒåR?", a: ["5", "pƒõtka", "nedostateƒçn√°"] },
                    { q: "Kolik let trv√° z√°kladn√≠ ≈°kola?", a: ["9", "devƒõt"] },
                    { q: "P≈ôedmƒõt se zkratkou 'M'?", a: ["matematika", "matika"] },
                    { q: "Kolik minut trv√° mal√° p≈ôest√°vka?", a: ["10", "deset"] }
                ],
                "WTF Fakty ü§Ø": [
                    { q: "Kter√© zv√≠≈ôe √∫dajnƒõ nikdy nesp√≠?", a: ["≈æ√°ba", "≈æralok", "frog", "shark", "bullfrog"] },
                    { q: "Kolik procent oce√°nu je prozkoum√°no?", a: ["5", "pƒõt"] },
                    { q: "Kter√© zv√≠≈ôe m√° modrou krev?", a: ["chobotnice", "octopus", "krakatice"] },
                    { q: "Kter√° planeta m√° den del≈°√≠ ne≈æ rok?", a: ["venu≈°e", "venus"] },
                    { q: "Nejrychlej≈°√≠ suchozemsk√© zv√≠≈ôe?", a: ["gepard", "cheetah"] }
                ],
                "Random üé≤": [
                    { q: "Kolik minut m√° hodina?", a: ["60", "≈°edes√°t"] },
                    { q: "Nejpopul√°rnƒõj≈°√≠ video hosting?", a: ["youtube", "—é—Ç—É–±"] },
                    { q: "Mƒõna Japonska?", a: ["jen", "yen"] },
                    { q: "Hlavn√≠ mƒõsto Francie?", a: ["pa≈ô√≠≈æ", "paris"] },
                    { q: "Kolik dn√≠ m√° rok?", a: ["365"] }
                ],
                "Adam Hojer üëë": [
                    { q: "Kolik let je Adamovi?", a: ["20", "dvacet", "21", "dvacet jedna"] },
                    { q: "V jak√©m mƒõs√≠ci m√° Adam narozeniny?", a: ["srpen", "august"] },
                    { q: "Na jak√© fakultƒõ studuje Adam?", a: ["ekonomick√°", "ekonomika", "vse"] },
                    { q: "Obl√≠ben√Ω dopravn√≠ prost≈ôedek Adama?", a: ["trolejbus", "tramvaj", "mhd"] },
                    { q: "Ve kter√©m mƒõstƒõ Adam studuje?", a: ["praha", "prague"] }
                ]
            }
        };

        const pointValues = [200, 400, 600, 800, 1000];

        // ===== –°–û–°–¢–û–Ø–ù–ò–ï =====
        let state = {
            phase: 'lobby',
            teams: [],
            round: 1,
            used: [],
            current: null,
            answering: null,
            tried: [],
            timerStart: null
        };

        let myTeam = localStorage.getItem('inquiz_team') || '';
        let timerInterval = null;
        let localUpdate = false;

        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
        function init() {
            createGarland();
            createSnowflakes();
            
            // Enter –¥–ª—è –≤–≤–æ–¥–∞
            document.getElementById('teamInput').addEventListener('keypress', e => {
                if (e.key === 'Enter') joinTeam();
            });
            document.getElementById('answerInput').addEventListener('keypress', e => {
                if (e.key === 'Enter') submitAnswer();
            });

            // –°–ª—É—à–∞–µ–º Firebase
            gameRef.on('value', snap => {
                if (localUpdate) return;
                const data = snap.val();
                if (data) {
                    state = { ...state, ...data };
                    render();
                }
            });
        }

        function save() {
            localUpdate = true;
            gameRef.set(state).then(() => {
                setTimeout(() => { localUpdate = false; }, 100);
            });
        }

        // ===== –†–ï–ù–î–ï–† =====
        function render() {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            
            if (state.phase === 'lobby') {
                document.getElementById('lobbyScreen').classList.add('active');
                renderTeams();
                hideModal();
            } 
            else if (state.phase === 'intro') {
                document.getElementById('introScreen').classList.add('active');
                showIntro();
                hideModal();
            }
            else if (state.phase === 'game') {
                document.getElementById('gameScreen').classList.add('active');
                renderScoreboard();
                renderBoard();
                
                if (state.current) {
                    showModal();
                } else {
                    hideModal();
                }
            }
        }

        // ===== –õ–û–ë–ë–ò =====
        function renderTeams() {
            const list = document.getElementById('teamsList');
            if (!state.teams || state.teams.length === 0) {
                list.innerHTML = '<div style="color: rgba(255,255,255,0.4)">Zat√≠m ≈æ√°dn√© t√Ωmy...</div>';
                return;
            }
            list.innerHTML = state.teams.map((t, i) => 
                `<div class="team-item ${t.name === myTeam ? 'my-team' : ''}">${i+1}. ${t.name}</div>`
            ).join('');
        }

        function joinTeam() {
            const input = document.getElementById('teamInput');
            const name = input.value.trim();
            if (!name) return alert('Zadejte n√°zev t√Ωmu!');
            if (state.teams && state.teams.some(t => t.name === name)) return alert('T√Ωm ji≈æ existuje!');
            
            if (!state.teams) state.teams = [];
            state.teams.push({ name, score: 0 });
            myTeam = name;
            localStorage.setItem('inquiz_team', myTeam);
            input.value = '';
            save();
        }

        function clearTeams() {
            const pass = prompt('Heslo pro vymaz√°n√≠:');
            if (pass !== '6952') return alert('≈†patn√© heslo!');
            state.teams = [];
            myTeam = '';
            localStorage.removeItem('inquiz_team');
            save();
        }

        function startGame() {
            const pass = document.getElementById('passwordInput').value;
            if (pass !== '6952') return alert('≈†patn√© heslo!');
            if (!state.teams || state.teams.length === 0) return alert('P≈ôidejte alespo≈à jeden t√Ωm!');
            
            state.phase = 'intro';
            state.round = 1;
            state.used = [];
            state.current = null;
            state.answering = null;
            state.tried = [];
            state.timerStart = null;
            save();
        }

        // ===== –ó–ê–°–¢–ê–í–ö–ê =====
        function showIntro() {
            document.getElementById('introTitle').textContent = `KOLO ${state.round}`;
            const themes = Object.keys(questions[state.round]);
            document.getElementById('themesList').innerHTML = themes.map(t => 
                `<div class="theme-item">${t}</div>`
            ).join('');
            
            // –ü–µ—Ä–µ—Ö–æ–¥ –∫ –∏–≥—Ä–µ —á–µ—Ä–µ–∑ 4 —Å–µ–∫
            setTimeout(() => {
                if (state.phase === 'intro') {
                    state.phase = 'game';
                    save();
                }
            }, 4000);
        }

        // ===== –ò–ì–†–ê =====
        function renderScoreboard() {
            const sb = document.getElementById('scoreboard');
            sb.innerHTML = state.teams.map((t, i) => {
                let cls = 'team-score';
                if (t.name === myTeam) cls += ' my-team';
                if (state.answering === i) cls += ' answering';
                return `<div class="${cls}">
                    <div class="name">${t.name}</div>
                    <div class="score">${t.score}</div>
                </div>`;
            }).join('');
            
            document.getElementById('roundBadge').textContent = `KOLO ${state.round}`;
        }

        function renderBoard() {
            const board = document.getElementById('board');
            const cats = Object.keys(questions[state.round]);
            
            let html = cats.map(c => `<div class="category">${c}</div>`).join('');
            
            pointValues.forEach((pts, row) => {
                cats.forEach((cat, col) => {
                    const id = `${state.round}-${col}-${row}`;
                    const used = state.used && state.used.includes(id);
                    html += `<div class="cell ${used ? 'used' : ''}" onclick="openQ('${cat}', ${row})">${pts}</div>`;
                });
            });
            
            board.innerHTML = html;
        }

        // ===== –í–û–ü–†–û–° =====
        function openQ(cat, idx) {
            const cats = Object.keys(questions[state.round]);
            const catIdx = cats.indexOf(cat);
            const id = `${state.round}-${catIdx}-${idx}`;
            
            if (state.used && state.used.includes(id)) return;
            if (state.current) return;
            
            const q = questions[state.round][cat][idx];
            state.current = {
                id,
                cat,
                pts: pointValues[idx],
                q: q.q,
                a: q.a
            };
            state.answering = null;
            state.tried = [];
            state.timerStart = Date.now();
            save();
        }

        function showModal() {
            const c = state.current;
            document.getElementById('modalCat').textContent = c.cat;
            document.getElementById('modalPts').textContent = c.pts;
            document.getElementById('modalQ').textContent = c.q;
            
            document.getElementById('result').className = 'result';
            document.getElementById('correctAnswer').style.display = 'none';
            document.getElementById('answerInput').value = '';
            
            updateBuzzState();
            document.getElementById('modal').classList.add('active');
            startTimer();
        }

        function hideModal() {
            document.getElementById('modal').classList.remove('active');
            stopTimer();
        }

        function updateBuzzState() {
            const buzzBtn = document.getElementById('buzzBtn');
            const answerBox = document.getElementById('answerBox');
            const info = document.getElementById('answeringInfo');
            
            const myIdx = state.teams.findIndex(t => t.name === myTeam);
            
            if (state.answering !== null && state.answering !== undefined) {
                buzzBtn.classList.add('disabled');
                info.style.display = 'block';
                document.getElementById('answeringTeam').textContent = state.teams[state.answering].name;
                
                if (state.answering === myIdx) {
                    answerBox.classList.add('active');
                    setTimeout(() => document.getElementById('answerInput').focus(), 100);
                } else {
                    answerBox.classList.remove('active');
                }
            } else {
                info.style.display = 'none';
                answerBox.classList.remove('active');
                
                if (myIdx === -1 || (state.tried && state.tried.includes(myIdx))) {
                    buzzBtn.classList.add('disabled');
                } else {
                    buzzBtn.classList.remove('disabled');
                }
            }
        }

        function buzz() {
            const myIdx = state.teams.findIndex(t => t.name === myTeam);
            if (myIdx === -1) return alert('Nejste v ≈æ√°dn√©m t√Ωmu!');
            if (state.answering !== null && state.answering !== undefined) return;
            if (state.tried && state.tried.includes(myIdx)) return;
            
            state.answering = myIdx;
            if (!state.tried) state.tried = [];
            state.tried.push(myIdx);
            save();
        }

        function submitAnswer() {
            const myIdx = state.teams.findIndex(t => t.name === myTeam);
            if (state.answering !== myIdx) return;
            
            const input = document.getElementById('answerInput').value.trim().toLowerCase();
            if (!input) return;
            
            const correct = state.current.a.some(a => {
                const answer = a.toLowerCase();
                return input === answer || input.includes(answer) || answer.includes(input);
            });
            
            const result = document.getElementById('result');
            
            if (correct) {
                result.textContent = '‚úÖ SPR√ÅVNƒö!';
                result.className = 'result correct';
                state.teams[myIdx].score += state.current.pts;
                
                if (!state.used) state.used = [];
                state.used.push(state.current.id);
                save();
                
                setTimeout(() => {
                    closeQ();
                }, 2000);
            } else {
                result.textContent = '‚ùå ≈†PATNƒö!';
                result.className = 'result wrong';
                state.teams[myIdx].score -= state.current.pts;
                state.answering = null;
                save();
                
                setTimeout(() => {
                    result.className = 'result';
                    
                    if (state.tried && state.tried.length >= state.teams.length) {
                        timeUp();
                    }
                }, 1500);
            }
        }

        function timeUp() {
            stopTimer();
            document.getElementById('buzzBtn').classList.add('disabled');
            document.getElementById('answerBox').classList.remove('active');
            
            const correct = document.getElementById('correctAnswer');
            correct.textContent = 'Spr√°vn√° odpovƒõƒè: ' + state.current.a[0];
            correct.style.display = 'block';
            
            if (!state.used) state.used = [];
            state.used.push(state.current.id);
            save();
            
            setTimeout(() => {
                closeQ();
            }, 3000);
        }

        function closeQ() {
            state.current = null;
            state.answering = null;
            state.tried = [];
            state.timerStart = null;
            save();
        }

        function closeQuestion() {
            const pass = prompt('Heslo pro zav≈ôen√≠:');
            if (pass !== '6952') return;
            
            if (state.current) {
                if (!state.used) state.used = [];
                state.used.push(state.current.id);
            }
            closeQ();
        }

        // ===== –¢–ê–ô–ú–ï–† =====
        function startTimer() {
            stopTimer();
            timerInterval = setInterval(updateTimer, 100);
        }

        function updateTimer() {
            if (!state.timerStart || !state.current) return;
            
            const elapsed = Math.floor((Date.now() - state.timerStart) / 1000);
            const remaining = Math.max(0, 20 - elapsed);
            
            const timer = document.getElementById('timer');
            timer.textContent = remaining;
            
            timer.classList.remove('warning', 'danger');
            if (remaining <= 5) timer.classList.add('danger');
            else if (remaining <= 10) timer.classList.add('warning');
            
            if (remaining <= 0 && state.current) {
                timeUp();
            }
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        // ===== –ê–î–ú–ò–ù =====
        function adminPanel() {
            const cmd = prompt('ADMIN PANEL\n\nP≈ô√≠kazy:\n1 - Kolo 1\n2 - Kolo 2\nreset - √öpln√Ω reset\nlobby - Zpƒõt do lobby\nscores - Upravit body');
            
            if (!cmd) return;
            
            if (cmd === '1') {
                const pass = prompt('Heslo:');
                if (pass !== '6952') return;
                state.round = 1;
                state.phase = 'intro';
                state.current = null;
                state.used = state.used ? state.used.filter(u => !u.startsWith('1-')) : [];
                save();
            } 
            else if (cmd === '2') {
                const pass = prompt('Heslo:');
                if (pass !== '6952') return;
                state.round = 2;
                state.phase = 'intro';
                state.current = null;
                state.used = state.used ? state.used.filter(u => !u.startsWith('2-')) : [];
                save();
            } 
            else if (cmd === 'reset') {
                const pass = prompt('Heslo pro reset:');
                if (pass !== '6952') return;
                state = {
                    phase: 'lobby',
                    teams: [],
                    round: 1,
                    used: [],
                    current: null,
                    answering: null,
                    tried: [],
                    timerStart: null
                };
                myTeam = '';
                localStorage.removeItem('inquiz_team');
                save();
            } 
            else if (cmd === 'lobby') {
                const pass = prompt('Heslo:');
                if (pass !== '6952') return;
                state.phase = 'lobby';
                state.current = null;
                save();
            }
            else if (cmd === 'scores') {
                const pass = prompt('Heslo:');
                if (pass !== '6952') return;
                const teamName = prompt('N√°zev t√Ωmu:');
                const team = state.teams.find(t => t.name.toLowerCase() === teamName.toLowerCase());
                if (!team) return alert('T√Ωm nenalezen!');
                const newScore = prompt('Nov√© body:', team.score);
                if (newScore !== null) {
                    team.score = parseInt(newScore) || 0;
                    save();
                }
            }
        }

        // ===== –î–ï–ö–û–†–ê–¶–ò–ò =====
        function createGarland() {
            const g = document.getElementById('garland');
            for (let i = 0; i < 30; i++) {
                g.innerHTML += '<div class="light"></div>';
            }
        }

        function createSnowflakes() {
            const s = document.getElementById('snowflakes');
            const flakes = ['‚ùÑ', '‚ùÖ', '‚ùÜ', '‚úª', '‚úº'];
            for (let i = 0; i < 40; i++) {
                const f = document.createElement('div');
                f.className = 'snowflake';
                f.innerHTML = flakes[Math.floor(Math.random() * flakes.length)];
                f.style.left = Math.random() * 100 + '%';
                f.style.animationDuration = (3 + Math.random() * 4) + 's';
                f.style.animationDelay = Math.random() * 5 + 's';
                f.style.fontSize = (8 + Math.random() * 12) + 'px';
                s.appendChild(f);
            }
        }

        // –°–¢–ê–†–¢
        init();
    </script>
</body>
</html>
