<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INQUIZ üéÑ</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(180deg, #0a1628 0%, #1a2a4a 100%);
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
        }

        /* –°–Ω–µ–∂–∏–Ω–∫–∏ */
        .snowflakes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            overflow: hidden;
        }

        .snowflake {
            position: absolute;
            top: -20px;
            color: #fff;
            font-size: 1rem;
            animation: fall linear infinite;
            opacity: 0.8;
        }

        @keyframes fall {
            0% { transform: translateY(-20px) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }

        /* –ì–∏—Ä–ª—è–Ω–¥–∞ */
        .garland {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 25px;
            display: flex;
            justify-content: space-around;
            z-index: 999;
            background: linear-gradient(180deg, rgba(0,50,0,0.8) 0%, transparent 100%);
        }

        .light {
            width: 12px;
            height: 18px;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            animation: glow 1.5s infinite;
        }

        @keyframes glow {
            0%, 100% { opacity: 1; filter: brightness(1.5) drop-shadow(0 0 8px currentColor); }
            50% { opacity: 0.6; }
        }

        .light:nth-child(5n+1) { background: #ff3333; color: #ff3333; animation-delay: 0s; }
        .light:nth-child(5n+2) { background: #33ff33; color: #33ff33; animation-delay: 0.3s; }
        .light:nth-child(5n+3) { background: #ffdd33; color: #ffdd33; animation-delay: 0.6s; }
        .light:nth-child(5n+4) { background: #3366ff; color: #3366ff; animation-delay: 0.9s; }
        .light:nth-child(5n+5) { background: #ff33ff; color: #ff33ff; animation-delay: 1.2s; }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 50px 20px;
            position: relative;
            z-index: 1;
        }

        /* –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è */
        .connection-status {
            position: fixed;
            top: 40px;
            left: 20px;
            padding: 8px 16px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 1001;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .connection-status.online {
            border-color: #22c55e;
            background: rgba(34,197,94,0.1);
        }

        /* –¢–∞–±–ª–æ –∫–æ–º–∞–Ω–¥ */
        .scoreboard {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .team-score {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 15px 25px;
            text-align: center;
            min-width: 140px;
        }

        .team-score.answering {
            border-color: #ffd700;
            box-shadow: 0 0 30px rgba(255,215,0,0.6);
            animation: pulse-team 0.8s infinite;
        }

        @keyframes pulse-team {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .team-name {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: rgba(255,255,255,0.8);
        }

        .team-points {
            font-size: 1.8rem;
            font-weight: 900;
            color: #ffd700;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞—É–Ω–¥–∞ */
        .round-intro {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            z-index: 3000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .round-intro.active {
            display: flex;
            animation: fadeIn 0.5s;
        }

        .round-title {
            font-size: 4rem;
            font-weight: 900;
            color: #ffd700;
            margin-bottom: 50px;
            text-shadow: 0 0 40px rgba(255,215,0,0.5);
        }

        .themes-list {
            max-width: 800px;
            width: 100%;
        }

        .theme-item {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px 30px;
            margin-bottom: 15px;
            font-size: 1.5rem;
            font-weight: 700;
            text-align: center;
            opacity: 0;
            transform: translateY(20px);
            animation: slideIn 0.5s forwards;
        }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .theme-item:nth-child(1) { animation-delay: 0.2s; }
        .theme-item:nth-child(2) { animation-delay: 0.4s; }
        .theme-item:nth-child(3) { animation-delay: 0.6s; }
        .theme-item:nth-child(4) { animation-delay: 0.8s; }
        .theme-item:nth-child(5) { animation-delay: 1s; }

        /* –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ */
        .game-board {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: auto repeat(5, 1fr);
            gap: 10px;
            margin-bottom: 30px;
        }

        .category-header {
            background: linear-gradient(145deg, #c41e3a, #8b0000);
            padding: 20px 10px;
            text-align: center;
            border-radius: 12px;
            font-weight: 700;
            font-size: 0.85rem;
            text-transform: uppercase;
            box-shadow: 0 4px 15px rgba(196,30,58,0.4);
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .question-cell {
            background: linear-gradient(145deg, #1e5128, #2d7a3a);
            border: 2px solid rgba(255,255,255,0.1);
            padding: 30px;
            text-align: center;
            border-radius: 12px;
            font-weight: 900;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #ffd700;
            box-shadow: 0 4px 15px rgba(30,81,40,0.4);
        }

        .question-cell:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(45,122,58,0.6);
            border-color: #ffd700;
        }

        .question-cell.used {
            background: rgba(50,50,50,0.5);
            color: rgba(255,255,255,0.2);
            cursor: not-allowed;
            box-shadow: none;
        }

        .question-cell.used:hover {
            transform: none;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–æ–ø—Ä–æ—Å–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(145deg, #1a2a4a, #0a1628);
            border: 3px solid rgba(255,215,0,0.3);
            border-radius: 25px;
            padding: 50px;
            max-width: 1000px;
            width: 100%;
            text-align: center;
        }

        .modal-category {
            font-size: 1rem;
            color: rgba(255,255,255,0.6);
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .modal-points {
            font-size: 4rem;
            font-weight: 900;
            color: #ffd700;
            margin-bottom: 30px;
        }

        .modal-question {
            font-size: 2rem;
            line-height: 1.6;
            margin-bottom: 40px;
        }

        .modal-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        /* –ö–Ω–æ–ø–∫–∞ "–û—Ç–≤–µ—Ç–∏—Ç—å" */
        .buzz-button {
            width: 200px;
            height: 200px;
            background: linear-gradient(145deg, #ef4444, #dc2626);
            border: 5px solid #ffd700;
            border-radius: 50%;
            font-size: 1.5rem;
            font-weight: 900;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
            margin: 30px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(239,68,68,0.4);
        }

        .buzz-button:hover:not(.disabled) {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(239,68,68,0.6);
        }

        .buzz-button.disabled {
            background: rgba(100,100,100,0.5);
            border-color: rgba(255,255,255,0.2);
            cursor: not-allowed;
        }

        /* –ü–æ–ª–µ –≤–≤–æ–¥–∞ –æ—Ç–≤–µ—Ç–∞ */
        .answer-input-container {
            display: none;
            margin: 30px 0;
        }

        .answer-input-container.active {
            display: block;
        }

        .answer-input {
            width: 100%;
            max-width: 500px;
            padding: 20px;
            font-size: 1.5rem;
            text-align: center;
            background: rgba(255,255,255,0.1);
            border: 3px solid #ffd700;
            border-radius: 15px;
            color: #fff;
            font-weight: 600;
        }

        .answer-input:focus {
            outline: none;
            box-shadow: 0 0 30px rgba(255,215,0,0.4);
        }

        .submit-answer-btn {
            margin-top: 20px;
            padding: 15px 50px;
            background: linear-gradient(145deg, #22c55e, #16a34a);
            border: none;
            border-radius: 50px;
            color: #fff;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit-answer-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(34,197,94,0.4);
        }

        /* –¢–∞–π–º–µ—Ä */
        .timer {
            font-size: 3rem;
            font-weight: 900;
            color: #4ade80;
            margin-bottom: 20px;
        }

        .timer.warning {
            color: #fbbf24;
        }

        .timer.danger {
            color: #ef4444;
            animation: pulse 0.5s infinite;
        }

        /* –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç */
        .answer-result {
            display: none;
            font-size: 2rem;
            font-weight: 900;
            margin: 20px 0;
            padding: 20px;
            border-radius: 15px;
        }

        .answer-result.correct {
            display: block;
            background: rgba(34,197,94,0.2);
            border: 3px solid #22c55e;
            color: #22c55e;
        }

        .answer-result.wrong {
            display: block;
            background: rgba(239,68,68,0.2);
            border: 3px solid #ef4444;
            color: #ef4444;
        }

        .correct-answer-display {
            margin-top: 20px;
            font-size: 1.3rem;
            color: #4ade80;
            padding: 15px;
            background: rgba(74,222,128,0.1);
            border-radius: 10px;
        }

        /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .admin-btn {
            position: fixed;
            top: 40px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            color: #fff;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 1001;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-buttons {
            margin-top: 30px;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50px;
            color: #fff;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        /* –õ–æ–±–±–∏ */
        .lobby-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #0a1628 0%, #1a2a4a 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 4000;
        }

        .lobby-content {
            text-align: center;
            max-width: 800px;
            padding: 50px;
        }

        .teams-list-item {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 15px;
            padding: 15px 25px;
            margin: 10px auto;
            font-size: 1.3rem;
            font-weight: 700;
            max-width: 400px;
            color: #ffd700;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 1200px) {
            .container {
                padding: 20px 10px;
            }
            
            .game-board {
                gap: 5px;
            }
            
            .category-header {
                font-size: 0.7rem;
                padding: 10px 5px;
                min-height: 60px;
            }
            
            .question-cell {
                padding: 15px 10px;
                font-size: 1.2rem;
            }
        }
        
        @media (max-width: 900px) {
            .scoreboard {
                gap: 8px;
            }
            
            .team-score {
                min-width: 100px;
                padding: 10px 15px;
            }
            
            .team-name {
                font-size: 0.75rem;
            }
            
            .team-points {
                font-size: 1.4rem;
            }
            
            .modal-content {
                padding: 30px 20px;
            }
            
            .modal-question {
                font-size: 1.3rem;
            }
            
            .buzz-button {
                width: 120px;
                height: 120px;
                font-size: 1rem;
            }
            
            .answer-input {
                font-size: 1.2rem;
                padding: 15px;
            }
        }
        
        @media (max-width: 600px) {
            .game-board {
                grid-template-columns: repeat(5, 1fr);
                gap: 3px;
            }
            
            .category-header {
                font-size: 0.5rem;
                padding: 5px 2px;
                min-height: 50px;
            }
            
            .question-cell {
                padding: 10px 5px;
                font-size: 0.9rem;
            }
            
            .modal-points {
                font-size: 2.5rem;
            }
            
            .timer {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <!-- –õ–æ–±–±–∏ -->
    <div class="lobby-screen" id="lobbyScreen">
        <div class="lobby-content">
            <h1 style="font-size: 4rem; margin-bottom: 30px; color: #ffd700;">üéÑ INQUIZ üéÑ</h1>
            <h2 style="margin-bottom: 40px;">V√°noƒçn√≠ Speci√°l ‚ùÑÔ∏è</h2>
            
            <div style="margin-bottom: 40px;">
                <input type="text" id="teamNameInput" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã..." 
                    style="width: 100%; max-width: 400px; padding: 20px; font-size: 1.3rem; text-align: center; 
                    background: rgba(255,255,255,0.1); border: 3px solid #ffd700; border-radius: 15px; color: #fff; font-weight: 600;">
                <button onclick="addTeam()" style="margin-top: 20px; padding: 20px 50px; font-size: 1.3rem; 
                    background: linear-gradient(145deg, #22c55e, #16a34a); border: none; border-radius: 50px; 
                    color: #fff; font-weight: 700; cursor: pointer;">
                    –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É
                </button>
            </div>
            
            <div id="teamsList" style="margin-bottom: 40px; min-height: 100px;">
                <h3 style="margin-bottom: 20px; color: rgba(255,255,255,0.7);">–ö–æ–º–∞–Ω–¥—ã –≤ –ª–æ–±–±–∏:</h3>
                <div id="teamsListContent"></div>
            </div>
            
            <div style="margin-top: 40px;">
                <input type="password" id="startPassword" placeholder="–ü–∞—Ä–æ–ª—å –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ (6952)" 
                    style="width: 100%; max-width: 300px; padding: 15px; font-size: 1.2rem; text-align: center; 
                    background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3); border-radius: 15px; 
                    color: #fff; font-weight: 600; margin-bottom: 20px;">
                <button onclick="startGame()" style="padding: 20px 60px; font-size: 1.5rem; 
                    background: linear-gradient(145deg, #ef4444, #dc2626); border: 3px solid #ffd700; 
                    border-radius: 50px; color: #fff; font-weight: 900; cursor: pointer; 
                    box-shadow: 0 10px 30px rgba(239,68,68,0.4);">
                    üöÄ –ù–ê–ß–ê–¢–¨ –ò–ì–†–£
                </button>
            </div>
        </div>
    </div>

    <!-- –ò–≥—Ä–∞ -->
    <div class="game-screen" id="gameScreen" style="display: none;">
    <!-- –ì–∏—Ä–ª—è–Ω–¥–∞ -->
    <div class="garland">
        <div class="light"></div><div class="light"></div><div class="light"></div><div class="light"></div><div class="light"></div>
        <div class="light"></div><div class="light"></div><div class="light"></div><div class="light"></div><div class="light"></div>
        <div class="light"></div><div class="light"></div><div class="light"></div><div class="light"></div><div class="light"></div>
        <div class="light"></div><div class="light"></div><div class="light"></div><div class="light"></div><div class="light"></div>
        <div class="light"></div><div class="light"></div><div class="light"></div><div class="light"></div><div class="light"></div>
    </div>

    <!-- –°–Ω–µ–∂–∏–Ω–∫–∏ -->
    <div class="snowflakes" id="snowflakes"></div>

    <!-- –°—Ç–∞—Ç—É—Å -->
    <div class="connection-status online">
        <div style="width: 8px; height: 8px; border-radius: 50%; background: #22c55e;"></div>
        <span>üåê Online</span>
    </div>

    <!-- –ê–¥–º–∏–Ω –∫–Ω–æ–ø–∫–∞ -->
    <button class="admin-btn" onclick="showAdminControls()">‚öôÔ∏è</button>

        <div class="container">
        <!-- –¢–∞–±–ª–æ –∫–æ–º–∞–Ω–¥ -->
        <div class="scoreboard" id="scoreboard"></div>

        <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
        <div class="game-board" id="gameBoard"></div>
    </div>
    </div>    <!-- –ó–∞—Å—Ç–∞–≤–∫–∞ —Ä–∞—É–Ω–¥–∞ -->
    <div class="round-intro" id="roundIntro">
        <div class="round-title" id="roundTitle">–†–ê–£–ù–î 1</div>
        <div class="themes-list" id="themesList"></div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–æ–ø—Ä–æ—Å–∞ -->
    <div class="modal" id="questionModal">
        <div class="modal-content">
            <div class="modal-category" id="modalCategory"></div>
            <div class="modal-points" id="modalPoints"></div>
            <div class="timer" id="timer">20</div>
            <div class="modal-question" id="modalQuestion"></div>
            <img class="modal-image" id="modalImage" style="display: none;" />
            
            <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–≤–µ—Ç–∏—Ç—å -->
            <button class="buzz-button" id="buzzButton" onclick="buzzIn()">
                üîî –û–¢–í–ï–¢–ò–¢–¨
            </button>

            <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ –æ—Ç–≤–µ—Ç–∞ -->
            <div class="answer-input-container" id="answerInputContainer">
                <div style="margin-bottom: 15px; font-size: 1.2rem;">
                    –û—Ç–≤–µ—á–∞–µ—Ç: <span id="answeringTeamName" style="color: #ffd700; font-weight: 900;"></span>
                </div>
                <input type="text" class="answer-input" id="answerInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç..." />
                <button class="submit-answer-btn" onclick="submitAnswer()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>

            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–≤–µ—Ç–∞ -->
            <div class="answer-result" id="answerResult"></div>
            <div class="correct-answer-display" id="correctAnswerDisplay" style="display: none;"></div>

            <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
            <div class="control-buttons">
                <button class="btn" onclick="closeQuestion()" style="display: none;" id="closeBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const firebaseConfig = {
            apiKey: "AIzaSyDwo2GKOXEDDs31kRfFCQLy_TcXRC2DF0",
            authDomain: "inquiz-a82e2.firebaseapp.com",
            databaseURL: "https://inquiz-a82e2-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "inquiz-a82e2",
            storageBucket: "inquiz-a82e2.firebasestorage.app",
            messagingSenderId: "943129879818",
            appId: "1:943129879818:web:366e32fe072182cd0d86f3",
            measurementId: "G-VY34PYJ9NJ"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const gameRef = database.ref('sigame');

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            gameStarted: false,
            teams: [],
            currentRound: 1,
            usedQuestions: [],
            currentQuestion: null,
            answeringTeam: null,
            timeLeft: 20,
            attemptedTeams: [],
            timerActive: false
        };

        let timerInterval = null;
        let isUpdatingFromFirebase = false;
        let myTeamIndex = null;
        let myTeamName = '';

        // –í–æ–ø—Ä–æ—Å—ã - –†–∞—É–Ω–¥ 1
        const round1 = {
            "Minecraft": [
                { points: 200, question: "Jak se jmenuje hlavn√≠ boss v Minecraftu?", answer: ["Ender Dragon", "enderdragon", "–¥—Ä–∞–∫–æ–Ω"], image: "" },
                { points: 400, question: "Kolik blok≈Ø obsidi√°nu pot≈ôebuje≈° na port√°l do Netheru?", answer: ["10", "–¥–µ—Å—è—Ç—å", "deset"] },
                { points: 600, question: "Jak se jmenuje dimenze, kde ≈æij√≠ Endermani?", answer: ["The End", "end", "—ç–Ω–¥", "–∫–æ–Ω–µ—Ü"] },
                { points: 800, question: "Jak√Ω p≈ôedmƒõt pot≈ôebuje≈° k ochoƒçen√≠ vlka?", answer: ["Kost", "bone", "–∫–æ—Å—Ç—å"] },
                { points: 1000, question: "V jak√©m roce vy≈°la pln√° verze Minecraft 1.0?", answer: ["2011"] }
            ],
            "Programov√°n√≠": [
                { points: 200, question: "Jak se naz√Ωv√° chyba v k√≥du?", answer: ["Bug", "–±–∞–≥", "chyba"] },
                { points: 400, question: "Kter√Ω programovac√≠ jazyk je pojmenov√°n po k√°vƒõ?", answer: ["Java", "–¥–∂–∞–≤–∞"] },
                { points: 600, question: "Co znamen√° HTML?", answer: ["HyperText Markup Language", "hypertext markup language"] },
                { points: 800, question: "Jak√Ω oper√°tor se pou≈æ√≠v√° pro porovn√°n√≠?", answer: ["==", "dvojit√© rovn√° se", "double equals"] },
                { points: 1000, question: "Jak se naz√Ωv√° datov√° struktura LIFO?", answer: ["Stack", "z√°sobn√≠k", "—Å—Ç–µ–∫"] }
            ],
            "IT & Tech": [
                { points: 200, question: "Co znamen√° zkratka USB?", answer: ["Universal Serial Bus"] },
                { points: 400, question: "Kter√° spoleƒçnost vytvo≈ôila iPhone?", answer: ["Apple", "—ç–ø–ª"] },
                { points: 600, question: "Co je RAM?", answer: ["Operaƒçn√≠ pamƒõ≈•", "Random Access Memory", "–ø–∞–º—è—Ç—å", "–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å"] },
                { points: 800, question: "V jak√©m roce byl zalo≈æen Google?", answer: ["1998"] },
                { points: 1000, question: "Jak se naz√Ωv√° protokol pro bezpeƒçn√Ω p≈ôenos dat?", answer: ["HTTPS", "https"] }
            ],
            "Memes & Internet": [
                { points: 200, question: "Jak√© slovo popisuje vtipn√Ω obr√°zek ≈°√≠≈ô√≠c√≠ se po internetu?", answer: ["Meme", "–º–µ–º"] },
                { points: 400, question: "Jak se jmenuje slavn√Ω meme s koƒçkou u stolu?", answer: ["Woman Yelling at Cat", "–∫–æ—Ç –∑–∞ —Å—Ç–æ–ª–æ–º"] },
                { points: 600, question: "Co znamen√° 'rickrolling'?", answer: ["Rick Astley", "Never Gonna Give You Up", "—Ä–∏–∫—Ä–æ–ª–ª"] },
                { points: 800, question: "Jak se jmenuje pes ze slavn√©ho meme 'Doge'?", answer: ["Kabosu", "Shiba Inu", "—à–∏–±–∞"] },
                { points: 1000, question: "Co znamen√° zkratka 'LOL'?", answer: ["Laughing Out Loud", "–ª–æ–ª"] }
            ],
            "V√°noce üéÑ": [
                { points: 200, question: "Jak se jmenuje sob s ƒçerven√Ωm nosem?", answer: ["Rudolf", "—Ä—É–¥–æ–ª—å—Ñ"] },
                { points: 400, question: "Ve kter√© zemi vznikla tradice v√°noƒçn√≠ho stromku?", answer: ["Nƒõmecko", "Germany", "–≥–µ—Ä–º–∞–Ω–∏—è"] },
                { points: 600, question: "Jak se jmenuje v√°noƒçn√≠ n√°poj z ml√©ka a vajec?", answer: ["Eggnog", "—ç–≥–Ω–æ–≥"] },
                { points: 800, question: "Kolik sob≈Ø t√°hne s√°nƒõ Santa Clause (bez Rudolfa)?", answer: ["8", "osm", "–≤–æ—Å–µ–º—å"] },
                { points: 1000, question: "Jak se jmenuje v√°noƒçn√≠ kalend√°≈ô s ok√©nky?", answer: ["Adventn√≠ kalend√°≈ô", "advent calendar"] }
            ]
        };

        // –í–æ–ø—Ä–æ—Å—ã - –†–∞—É–Ω–¥ 2
        const round2 = {
            "Games üéÆ": [
                { points: 200, question: "Jak√° hra m√° mapu 'Dust 2'?", answer: ["Counter-Strike", "CS", "–∫–æ–Ω—Ç—Ä —Å—Ç—Ä–∞–π–∫"] },
                { points: 400, question: "V jak√© h≈ôe sb√≠r√°≈° 'V-Bucks'?", answer: ["Fortnite", "—Ñ–æ—Ä–Ω–∞–π—Ç"] },
                { points: 600, question: "Hlavn√≠ postava v 'The Witcher'?", answer: ["Geralt", "Geralt z Rivie", "–≤–µ–¥—å–º–∞–∫"] },
                { points: 800, question: "Kter√° hra m√° easter egg 'Do a barrel roll'?", answer: ["Star Fox", "—Å—Ç–∞—Ä—Ñ–æ–∫—Å"] },
                { points: 1000, question: "Hern√≠ engine od Epic Games?", answer: ["Unreal Engine", "–∞–Ω—Ä–∏–∞–ª"] }
            ],
            "School Life üìö": [
                { points: 200, question: "Kolik minut m√° vyuƒçovac√≠ hodina?", answer: ["45", "ƒçty≈ôicet pƒõt"] },
                { points: 400, question: "Nejhor≈°√≠ zn√°mka v ƒçesk√©m ≈°kolstv√≠?", answer: ["5", "nedostateƒçn√°", "–ø—è—Ç–µ—Ä–∫–∞"] },
                { points: 600, question: "Kter√Ω p≈ôedmƒõt se nen√°vid√≠ nejv√≠ce?", answer: ["Matematika", "–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞", "matika"] },
                { points: 800, question: "Jak√Ω p≈ôedmƒõt m√° zkratku 'M'?", answer: ["Matematika", "–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞"] },
                { points: 1000, question: "Kolik let trv√° z√°kladn√≠ vzdƒõl√°n√≠ v ƒåR?", answer: ["9", "devƒõt", "–¥–µ–≤—è—Ç—å"] }
            ],
            "WTF Fakty ü§Ø": [
                { points: 200, question: "Kter√© zv√≠≈ôe nikdy nesp√≠?", answer: ["≈Ω√°ba", "frog", "–ª—è–≥—É—à–∫–∞"] },
                { points: 400, question: "Kolik procent oce√°nu bylo prozkoum√°no?", answer: ["5", "–ø—è—Ç—å", "pƒõt procent"] },
                { points: 600, question: "Kter√© zv√≠≈ôe m√° modrou krev?", answer: ["Chobotnice", "octopus", "–æ—Å—å–º–∏–Ω–æ–≥"] },
                { points: 800, question: "Kolik let m≈Ø≈æe p≈ôe≈æ√≠t tardigrade bez vody?", answer: ["10", "deset", "–¥–µ—Å—è—Ç—å"] },
                { points: 1000, question: "Kter√° planeta m√° den del≈°√≠ ne≈æ rok?", answer: ["Venu≈°e", "Venus", "–≤–µ–Ω–µ—Ä–∞"] }
            ],
            "Random üé≤": [
                { points: 200, question: "Kolik minut m√° jedna hodina?", answer: ["60", "≈°edes√°t"] },
                { points: 400, question: "Nejpopul√°rnƒõj≈°√≠ video hosting?", answer: ["YouTube", "—é—Ç—É–±"] },
                { points: 600, question: "Mƒõna Japonska?", answer: ["Jen", "Yen", "–∏–µ–Ω–∞"] },
                { points: 800, question: "Kolik kl√°ves m√° standardn√≠ kl√°vesnice?", answer: ["104", "sto ƒçty≈ôi"] },
                { points: 1000, question: "Ve kter√© zemi byla vynalezena pizza?", answer: ["It√°lie", "Italy", "–∏—Ç–∞–ª–∏—è"] }
            ],
            "Adam Hojer üëë": [
                { points: 200, question: "Kolik je Adamovi let?", answer: ["20", "dvacet", "–¥–≤–∞–¥—Ü–∞—Ç—å"] },
                { points: 400, question: "V jak√©m mƒõs√≠ci m√° Adam narozeniny?", answer: ["Srpen", "August", "–∞–≤–≥—É—Å—Ç"] },
                { points: 600, question: "Na jak√© fakultƒõ studuje Adam?", answer: ["Ekonomick√°", "ekonomika", "—ç–∫–æ–Ω–æ–º–∏–∫–∞"] },
                { points: 800, question: "Obl√≠ben√Ω dopravn√≠ prost≈ôedek Adama?", answer: ["Trolejbus", "—Ç—Ä–æ–ª–ª–µ–π–±—É—Å"] },
                { points: 1000, question: "Kde bylo foto Adama z Instagramu?", answer: ["TechTower", "SitPort", "SeedUp", "—Ç–µ—Ö—Ç–∞—É—ç—Ä"] }
            ]
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–Ω–µ–∂–∏–Ω–æ–∫
        function createSnowflakes() {
            const container = document.getElementById('snowflakes');
            const flakes = ['‚ùÑ', '‚ùÖ', '‚ùÜ', '‚úª', '‚úº', '‚ùâ'];
            
            for (let i = 0; i < 40; i++) {
                const flake = document.createElement('div');
                flake.className = 'snowflake';
                flake.innerHTML = flakes[Math.floor(Math.random() * flakes.length)];
                flake.style.left = Math.random() * 100 + '%';
                flake.style.animationDuration = (Math.random() * 4 + 3) + 's';
                flake.style.animationDelay = Math.random() * 5 + 's';
                flake.style.fontSize = (Math.random() * 12 + 8) + 'px';
                container.appendChild(flake);
            }
        }

        // –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É
        function addTeam() {
            const input = document.getElementById('teamNameInput');
            const teamName = input.value.trim();
            
            if (!teamName) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã!');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞
            if (gameState.teams.some(t => t.name === teamName)) {
                alert('–ö–æ–º–∞–Ω–¥–∞ —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!');
                return;
            }
            
            gameState.teams.push({ name: teamName, score: 0 });
            myTeamName = teamName;
            myTeamIndex = gameState.teams.length - 1;
            localStorage.setItem('myTeamName', myTeamName);
            
            input.value = '';
            saveGame();
            renderTeamsList();
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥ –≤ –ª–æ–±–±–∏
        function renderTeamsList() {
            const container = document.getElementById('teamsListContent');
            if (gameState.teams.length === 0) {
                container.innerHTML = '<div style="color: rgba(255,255,255,0.5);">–ö–æ–º–∞–Ω–¥ –ø–æ–∫–∞ –Ω–µ—Ç...</div>';
                return;
            }
            
            container.innerHTML = gameState.teams.map((team, idx) => 
                `<div class="teams-list-item">${idx + 1}. ${team.name}</div>`
            ).join('');
        }

        // –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
        function startGame() {
            const password = document.getElementById('startPassword').value;
            
            if (password !== '6952') {
                alert('–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å!');
                return;
            }
            
            if (gameState.teams.length === 0) {
                alert('–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∫–æ–º–∞–Ω–¥—É!');
                return;
            }
            
            gameState.gameStarted = true;
            saveGame();
            
            document.getElementById('lobbyScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            
            renderScoreboard();
            renderGameBoard();
            showRoundIntro(1);
        }

        // –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
        function normalizeAnswer(answer) {
            return answer.toLowerCase().trim()
                .replace(/\s+/g, ' ')
                .replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g, '');
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞
        function checkAnswer(userAnswer, correctAnswers) {
            const normalized = normalizeAnswer(userAnswer);
            return correctAnswers.some(correct => 
                normalizeAnswer(correct) === normalized ||
                normalizeAnswer(correct).includes(normalized) ||
                normalized.includes(normalizeAnswer(correct))
            );
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–∞–±–ª–æ
        function renderScoreboard() {
            const board = document.getElementById('scoreboard');
            board.innerHTML = '';
            
            gameState.teams.forEach((team, index) => {
                const card = document.createElement('div');
                card.className = 'team-score';
                if (gameState.answeringTeam === index) {
                    card.classList.add('answering');
                }
                card.innerHTML = `
                    <div class="team-name">${team.name}</div>
                    <div class="team-points">${team.score}</div>
                `;
                board.appendChild(card);
            });
        }

        // –ü–æ–∫–∞–∑ –∑–∞—Å—Ç–∞–≤–∫–∏ —Ä–∞—É–Ω–¥–∞
        function showRoundIntro(roundNum) {
            const intro = document.getElementById('roundIntro');
            const title = document.getElementById('roundTitle');
            const list = document.getElementById('themesList');
            
            const themes = roundNum === 1 ? Object.keys(round1) : Object.keys(round2);
            
            title.textContent = `–†–ê–£–ù–î ${roundNum}`;
            list.innerHTML = '';
            
            themes.forEach(theme => {
                const item = document.createElement('div');
                item.className = 'theme-item';
                item.textContent = theme;
                list.appendChild(item);
            });
            
            intro.classList.add('active');
            
            setTimeout(() => {
                intro.classList.remove('active');
            }, 4000);
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
        function renderGameBoard() {
            const board = document.getElementById('gameBoard');
            if (!board) return;
            
            board.innerHTML = '';
            
            const currentRound = gameState.currentRound === 1 ? round1 : round2;
            const categories = Object.keys(currentRound);
            const points = [200, 400, 600, 800, 1000];
            
            // –£–±–µ–¥–∏–º—Å—è —á—Ç–æ usedQuestions - –º–∞—Å—Å–∏–≤
            if (!Array.isArray(gameState.usedQuestions)) {
                gameState.usedQuestions = [];
            }
            
            console.log('Rendering game board:', categories, points);
            
            // –°–æ–∑–¥–∞–µ–º —Å–µ—Ç–∫—É: —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∏
            categories.forEach(cat => {
                const header = document.createElement('div');
                header.className = 'category-header';
                header.textContent = cat;
                board.appendChild(header);
            });
            
            // –í–æ–ø—Ä–æ—Å—ã –ø–æ—Å—Ç—Ä–æ—á–Ω–æ (–ø–æ —Ä—è–¥–∞–º)
            points.forEach(point => {
                categories.forEach(cat => {
                    const cell = document.createElement('div');
                    const questionId = `r${gameState.currentRound}-${cat}-${point}`;
                    const isUsed = gameState.usedQuestions.includes(questionId);
                    
                    cell.className = `question-cell ${isUsed ? 'used' : ''}`;
                    cell.textContent = point;
                    
                    if (!isUsed) {
                        cell.onclick = () => openQuestion(cat, point);
                    }
                    
                    board.appendChild(cell);
                });
            });
            
            console.log('Board children:', board.children.length);
        }

        // –û—Ç–∫—Ä—ã—Ç—å –≤–æ–ø—Ä–æ—Å
        function openQuestion(category, points) {
            const currentRound = gameState.currentRound === 1 ? round1 : round2;
            const question = currentRound[category].find(q => q.points === points);
            
            if (!question) return;
            
            gameState.currentQuestion = {
                category,
                points,
                ...question
            };
            gameState.answeringTeam = null;
            gameState.attemptedTeams = [];
            gameState.timeLeft = 20;
            
            saveGame(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–Ω–∞—á–∞–ª–∞, —á—Ç–æ–±—ã –≤—Å–µ —É–≤–∏–¥–µ–ª–∏
            showQuestionModal();
            startTimer();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –≤–æ–ø—Ä–æ—Å–æ–º
        function showQuestionModal() {
            if (!gameState.currentQuestion) return;
            
            const question = gameState.currentQuestion;
            
            document.getElementById('modalCategory').textContent = question.category;
            document.getElementById('modalPoints').textContent = question.points;
            document.getElementById('modalQuestion').textContent = question.question;
            
            const img = document.getElementById('modalImage');
            if (question.image) {
                img.src = question.image;
                img.style.display = 'block';
            } else {
                img.style.display = 'none';
            }
            
            document.getElementById('buzzButton').classList.remove('disabled');
            document.getElementById('answerInputContainer').classList.remove('active');
            document.getElementById('answerResult').className = 'answer-result';
            document.getElementById('correctAnswerDisplay').style.display = 'none';
            document.getElementById('closeBtn').style.display = 'none';
            document.getElementById('answerInput').value = '';
            
            document.getElementById('questionModal').classList.add('active');
        }

        // –¢–∞–π–º–µ—Ä
        function startTimer() {
            stopTimer();
            gameState.timeLeft = 20;
            gameState.timerActive = true;
            saveGame();
            updateTimerDisplay();
            
            timerInterval = setInterval(() => {
                gameState.timeLeft--;
                saveGame(); // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Ç–∞–π–º–µ—Ä
                updateTimerDisplay();
                
                if (gameState.timeLeft <= 0) {
                    stopTimer();
                    showCorrectAnswer();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const timer = document.getElementById('timer');
            if (!timer) return;
            
            timer.textContent = gameState.timeLeft;
            
            timer.classList.remove('warning', 'danger');
            if (gameState.timeLeft <= 5) {
                timer.classList.add('danger');
            } else if (gameState.timeLeft <= 10) {
                timer.classList.add('warning');
            }
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            gameState.timerActive = false;
            saveGame();
        }

        // –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ "–û—Ç–≤–µ—Ç–∏—Ç—å"
        function buzzIn() {
            if (!gameState.currentQuestion || gameState.answeringTeam !== null) return;
            
            // –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞
            if (myTeamIndex === null || myTeamIndex === -1) {
                alert('–í—ã –Ω–µ –¥–æ–±–∞–≤–∏–ª–∏ —Å–≤–æ—é –∫–æ–º–∞–Ω–¥—É –≤ –ª–æ–±–±–∏!');
                return;
            }
            
            if (gameState.attemptedTeams && gameState.attemptedTeams.includes(myTeamIndex)) {
                alert('–í–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ —É–∂–µ –ø—ã—Ç–∞–ª–∞—Å—å –æ—Ç–≤–µ—Ç–∏—Ç—å!');
                return;
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ç–≤–µ—á–∞—é—â—É—é –∫–æ–º–∞–Ω–¥—É
            gameState.answeringTeam = myTeamIndex;
            if (!gameState.attemptedTeams) gameState.attemptedTeams = [];
            gameState.attemptedTeams.push(myTeamIndex);
            
            saveGame(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —á—Ç–æ–±—ã –≤—Å–µ —É–≤–∏–¥–µ–ª–∏
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞
        function submitAnswer() {
            const userAnswer = document.getElementById('answerInput').value.trim();
            if (!userAnswer) return;
            
            const isCorrect = checkAnswer(userAnswer, gameState.currentQuestion.answer);
            
            const resultEl = document.getElementById('answerResult');
            
            if (isCorrect) {
                resultEl.textContent = '‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û!';
                resultEl.className = 'answer-result correct';
                gameState.teams[gameState.answeringTeam].score += gameState.currentQuestion.points;
                stopTimer();
                saveGame();
                
                setTimeout(() => {
                    markQuestionUsed();
                    closeQuestion();
                }, 2000);
            } else {
                resultEl.textContent = '‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!';
                resultEl.className = 'answer-result wrong';
                gameState.teams[gameState.answeringTeam].score -= gameState.currentQuestion.points;
                saveGame();
                
                setTimeout(() => {
                    resultEl.className = 'answer-result';
                    document.getElementById('answerInputContainer').classList.remove('active');
                    gameState.answeringTeam = null;
                    document.getElementById('answerInput').value = '';
                    document.getElementById('buzzButton').classList.remove('disabled');
                    saveGame();
                    renderScoreboard();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –µ—â–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–≤–µ—Ç–∞
                    const remainingTeams = gameState.teams.length - (gameState.attemptedTeams ? gameState.attemptedTeams.length : 0);
                    if (remainingTeams === 0) {
                        showCorrectAnswer();
                    }
                }, 1500);
            }
            
            renderScoreboard();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
        function showCorrectAnswer() {
            stopTimer();
            document.getElementById('buzzButton').classList.add('disabled');
            document.getElementById('answerInputContainer').classList.remove('active');
            
            const display = document.getElementById('correctAnswerDisplay');
            display.textContent = `–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${gameState.currentQuestion.answer[0]}`;
            display.style.display = 'block';
            
            document.getElementById('closeBtn').style.display = 'inline-block';
        }

        // –ó–∞–∫—Ä—ã—Ç—å –≤–æ–ø—Ä–æ—Å
        function closeQuestion() {
            markQuestionUsed();
            stopTimer();
            gameState.currentQuestion = null;
            gameState.answeringTeam = null;
            gameState.attemptedTeams = [];
            saveGame(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —á—Ç–æ–±—ã –≤—Å–µ –∑–∞–∫—Ä—ã–ª–∏ –º–æ–¥–∞–ª–∫—É
            document.getElementById('questionModal').classList.remove('active');
            renderScoreboard();
        }

        // –ü–æ–º–µ—Ç–∏—Ç—å –≤–æ–ø—Ä–æ—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–º
        function markQuestionUsed() {
            if (!gameState.currentQuestion) return;
            const questionId = `r${gameState.currentRound}-${gameState.currentQuestion.category}-${gameState.currentQuestion.points}`;
            if (!gameState.usedQuestions.includes(questionId)) {
                gameState.usedQuestions.push(questionId);
            }
            renderGameBoard();
            saveGame();
        }

        // –ê–¥–º–∏–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å
        function showAdminControls() {
            const action = prompt('–ö–æ–º–∞–Ω–¥—ã:\n1r - –†–∞—É–Ω–¥ 1\n2r - –†–∞—É–Ω–¥ 2\nreset - –°–±—Ä–æ—Å –∏–≥—Ä—ã –≤ –ª–æ–±–±–∏\n–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:');
            
            if (action === '1r') {
                gameState.currentRound = 1;
                showRoundIntro(1);
                setTimeout(() => renderGameBoard(), 4000);
                saveGame();
            } else if (action === '2r') {
                gameState.currentRound = 2;
                showRoundIntro(2);
                setTimeout(() => renderGameBoard(), 4000);
                saveGame();
            } else if (action === 'reset') {
                if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É –≤ –ª–æ–±–±–∏?')) {
                    gameState = {
                        gameStarted: false,
                        teams: [],
                        currentRound: 1,
                        usedQuestions: [],
                        currentQuestion: null,
                        answeringTeam: null,
                        timeLeft: 20,
                        attemptedTeams: [],
                        timerActive: false
                    };
                    myTeamIndex = null;
                    myTeamName = '';
                    localStorage.removeItem('myTeamName');
                    saveGame();
                }
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Firebase
        function saveGame() {
            if (!isUpdatingFromFirebase) {
                gameRef.set(gameState).catch(err => console.error('Save error:', err));
            }
        }

        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Firebase
        gameRef.on('value', (snapshot) => {
            const data = snapshot.val();
            
            // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            if (!data) {
                gameState = {
                    gameStarted: false,
                    teams: [],
                    currentRound: 1,
                    usedQuestions: [],
                    currentQuestion: null,
                    answeringTeam: null,
                    timeLeft: 20,
                    attemptedTeams: [],
                    timerActive: false
                };
                renderTeamsList();
                return;
            }
            
            if (!isUpdatingFromFirebase) {
                isUpdatingFromFirebase = true;
                
                // –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Ä–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ Firebase
                gameState = {
                    gameStarted: data.gameStarted || false,
                    teams: data.teams || [],
                    currentRound: data.currentRound || 1,
                    usedQuestions: data.usedQuestions || [],
                    currentQuestion: data.currentQuestion || null,
                    answeringTeam: data.answeringTeam !== undefined ? data.answeringTeam : null,
                    timeLeft: data.timeLeft || 20,
                    attemptedTeams: data.attemptedTeams || [],
                    timerActive: data.timerActive || false
                };
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–æ—é –∫–æ–º–∞–Ω–¥—É
                if (myTeamName) {
                    myTeamIndex = gameState.teams.findIndex(t => t.name === myTeamName);
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω
                if (gameState.gameStarted) {
                    document.getElementById('lobbyScreen').style.display = 'none';
                    document.getElementById('gameScreen').style.display = 'block';
                    renderScoreboard();
                    renderGameBoard();
                    
                    // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
                    if (gameState.currentQuestion) {
                        if (!document.getElementById('questionModal').classList.contains('active')) {
                            showQuestionModal();
                        }
                        updateTimerDisplay();
                        
                        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω –∞–∫—Ç–∏–≤–µ–Ω –∏ –µ—â–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω
                        if (gameState.timerActive && !timerInterval && gameState.timeLeft > 0) {
                            timerInterval = setInterval(() => {
                                updateTimerDisplay();
                            }, 1000);
                        }
                    } else {
                        document.getElementById('questionModal').classList.remove('active');
                        stopTimer();
                    }
                    
                    updateUIForCurrentState();
                } else {
                    document.getElementById('lobbyScreen').style.display = 'flex';
                    document.getElementById('gameScreen').style.display = 'none';
                    renderTeamsList();
                }
                
                setTimeout(() => {
                    isUpdatingFromFirebase = false;
                }, 100);
            }
        });

        // –°–ª—É—à–∞–µ–º –ø–æ–ø—ã—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏
        database.ref('sigame/buzzOrder').on('child_added', (snapshot) => {
            if (gameState.answeringTeam !== null || !gameState.currentQuestion) return;
            
            const buzzData = snapshot.val();
            const teamIndex = buzzData.teamIndex;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –µ—â–µ –Ω–µ –ø—ã—Ç–∞–ª–∞—Å—å
            if (gameState.attemptedTeams.includes(teamIndex)) return;
            
            // –ü–µ—Ä–≤—ã–π –∫—Ç–æ –Ω–∞–∂–∞–ª - –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∞–≤–æ –æ—Ç–≤–µ—Ç–∞
            gameState.answeringTeam = teamIndex;
            gameState.attemptedTeams.push(teamIndex);
            
            // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
            database.ref('sigame/buzzOrder').remove();
            
            saveGame();
            updateUIForAnswering();
        });

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
        function updateUIForCurrentState() {
            const buzzBtn = document.getElementById('buzzButton');
            const inputContainer = document.getElementById('answerInputContainer');
            
            if (!gameState.currentQuestion || !buzzBtn) return;
            
            // –ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç
            if (gameState.answeringTeam !== null) {
                buzzBtn.classList.add('disabled');
                document.getElementById('answeringTeamName').textContent = gameState.teams[gameState.answeringTeam].name;
                
                // –ï—Å–ª–∏ –æ—Ç–≤–µ—á–∞–µ—Ç –º–æ—è –∫–æ–º–∞–Ω–¥–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
                if (gameState.answeringTeam === myTeamIndex) {
                    inputContainer.classList.add('active');
                    setTimeout(() => {
                        document.getElementById('answerInput').focus();
                    }, 100);
                } else {
                    inputContainer.classList.remove('active');
                }
            } else {
                // –ù–∏–∫—Ç–æ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç - –∫–Ω–æ–ø–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
                if (myTeamIndex !== null && myTeamIndex !== -1 && 
                    (!gameState.attemptedTeams || !gameState.attemptedTeams.includes(myTeamIndex))) {
                    buzzBtn.classList.remove('disabled');
                } else {
                    buzzBtn.classList.add('disabled');
                }
                inputContainer.classList.remove('active');
            }
        }

        // Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞
        document.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && document.getElementById('answerInputContainer').classList.contains('active')) {
                submitAnswer();
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        createSnowflakes();
        
        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—É –∏–∑ localStorage
        const savedTeamName = localStorage.getItem('myTeamName');
        if (savedTeamName) {
            myTeamName = savedTeamName;
        }
        
        renderTeamsList();
    </script>
</body>
</html>