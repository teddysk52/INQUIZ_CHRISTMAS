<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INQUIZ üéÑ V√°noƒçn√≠ Speci√°l</title>
    <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@700&family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(180deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
            position: relative;
        }

        /* –°–ù–ï–ñ–ò–ù–ö–ò */
        .snowflakes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9998;
        }

        .snowflake {
            position: absolute;
            top: -20px;
            color: #fff;
            font-size: 1rem;
            animation: fall linear infinite;
            opacity: 0.8;
            text-shadow: 0 0 5px rgba(255,255,255,0.5);
        }

        @keyframes fall {
            0% { transform: translateY(-20px) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }

        /* –ì–ò–†–õ–Ø–ù–î–ê */
        .garland {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 30px;
            display: flex;
            justify-content: space-around;
            z-index: 9999;
            background: linear-gradient(180deg, rgba(15,23,42,0.9) 0%, transparent 100%);
        }

        .light {
            width: 15px;
            height: 20px;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            animation: glow 1.5s infinite;
        }

        @keyframes glow {
            0%, 100% { opacity: 1; filter: brightness(1.8) drop-shadow(0 0 10px currentColor); }
            50% { opacity: 0.5; }
        }

        .light:nth-child(6n+1) { background: #ef4444; color: #ef4444; animation-delay: 0s; }
        .light:nth-child(6n+2) { background: #22c55e; color: #22c55e; animation-delay: 0.25s; }
        .light:nth-child(6n+3) { background: #fbbf24; color: #fbbf24; animation-delay: 0.5s; }
        .light:nth-child(6n+4) { background: #3b82f6; color: #3b82f6; animation-delay: 0.75s; }
        .light:nth-child(6n+5) { background: #a855f7; color: #a855f7; animation-delay: 1s; }
        .light:nth-child(6n) { background: #ec4899; color: #ec4899; animation-delay: 1.25s; }

        /* –î–ï–î –ú–û–†–û–ó –ù–ê –°–ê–ù–Ø–• */
        .santa {
            position: fixed;
            top: 15%;
            left: -200px;
            font-size: 3rem;
            z-index: 9997;
            animation: santaFly 20s linear infinite;
        }

        @keyframes santaFly {
            0% { left: -200px; }
            100% { left: 110%; }
        }

        /* –ö–û–ù–¢–ï–ô–ù–ï–† */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 50px 20px 20px;
            position: relative;
            z-index: 1;
        }

        h1 {
            text-align: center;
            font-family: 'Mountains of Christmas', cursive;
            font-size: 4rem;
            color: #ffd700;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255,215,0,0.5), 0 0 40px rgba(255,215,0,0.3);
            animation: titleGlow 2s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { text-shadow: 0 0 20px rgba(255,215,0,0.5), 0 0 40px rgba(255,215,0,0.3); }
            50% { text-shadow: 0 0 30px rgba(255,215,0,0.8), 0 0 60px rgba(255,215,0,0.5); }
        }

        h2 {
            text-align: center;
            font-size: 1.5rem;
            color: rgba(255,255,255,0.8);
            margin-bottom: 40px;
        }

        /* –õ–û–ë–ë–ò */
        #lobby {
            text-align: center;
            padding: 20px;
        }

        .input-field {
            padding: 18px 25px;
            font-size: 1.3rem;
            border: 3px solid #ffd700;
            border-radius: 15px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            color: #fff;
            width: 100%;
            max-width: 400px;
            margin: 10px;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s;
        }

        .input-field:focus {
            outline: none;
            border-color: #22c55e;
            box-shadow: 0 0 20px rgba(34,197,94,0.5);
        }

        .input-field::placeholder {
            color: rgba(255,255,255,0.5);
        }

        .btn {
            padding: 18px 50px;
            font-size: 1.3rem;
            font-weight: 700;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-green {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: #fff;
            box-shadow: 0 10px 30px rgba(34,197,94,0.4);
        }

        .btn-green:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(34,197,94,0.6);
        }

        .btn-red {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: #fff;
            border: 3px solid #ffd700;
            box-shadow: 0 10px 30px rgba(239,68,68,0.4);
        }

        .btn-red:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(239,68,68,0.6);
        }

        .btn-gray {
            background: rgba(255,255,255,0.1);
            color: #fff;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .btn-gray:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .teams-list {
            margin: 30px auto;
            max-width: 600px;
        }

        .teams-title {
            font-size: 1.3rem;
            color: rgba(255,255,255,0.7);
            margin-bottom: 20px;
        }

        .team-item {
            padding: 18px 30px;
            margin: 12px 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: 600;
            color: #ffd700;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .team-item:hover {
            transform: translateX(5px);
            border-color: #ffd700;
        }

        /* –ò–ì–†–ê */
        #game {
            display: none;
        }

        .scoreboard {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .team-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 20px;
            padding: 20px 30px;
            min-width: 160px;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .team-card.active {
            border-color: #3b82f6;
            background: linear-gradient(135deg, rgba(59,130,246,0.3), rgba(59,130,246,0.1));
            box-shadow: 0 0 40px rgba(59,130,246,0.6);
            transform: scale(1.05);
        }

        .team-card.answering {
            border-color: #22c55e;
            background: linear-gradient(135deg, rgba(34,197,94,0.3), rgba(34,197,94,0.1));
            animation: pulse 0.6s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 30px rgba(34,197,94,0.5); }
            50% { transform: scale(1.08); box-shadow: 0 0 50px rgba(34,197,94,0.8); }
        }

        .team-name {
            font-size: 1rem;
            color: rgba(255,255,255,0.8);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .team-score {
            font-size: 2.5rem;
            font-weight: 900;
            color: #ffd700;
            text-shadow: 0 0 15px rgba(255,215,0,0.5);
        }

        .info-banner {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, rgba(59,130,246,0.3), rgba(59,130,246,0.1));
            border: 3px solid #3b82f6;
            border-radius: 20px;
            margin-bottom: 25px;
            font-size: 1.4rem;
            font-weight: 700;
            color: #60a5fa;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 40px rgba(59,130,246,0.3);
        }

        .info-banner strong {
            color: #ffd700;
            font-size: 1.6rem;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
        }

        .category {
            background: linear-gradient(135deg, #dc2626, #991b1b);
            padding: 20px 10px;
            text-align: center;
            border-radius: 15px;
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            min-height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 20px rgba(220,38,38,0.4);
            border: 2px solid rgba(255,255,255,0.2);
        }

        .cell {
            background: linear-gradient(135deg, #16a34a, #15803d);
            border: 3px solid rgba(255,255,255,0.2);
            padding: 35px;
            text-align: center;
            border-radius: 15px;
            font-weight: 900;
            font-size: 2rem;
            color: #ffd700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(22,163,74,0.4);
            position: relative;
            overflow: hidden;
        }

        .cell::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.4s, height 0.4s;
        }

        .cell:hover:not(.used)::before {
            width: 200%;
            height: 200%;
        }

        .cell:hover:not(.used) {
            transform: scale(1.08) rotate(2deg);
            border-color: #ffd700;
            box-shadow: 0 10px 40px rgba(255,215,0,0.6);
        }

        .cell.used {
            background: linear-gradient(135deg, rgba(50,50,50,0.6), rgba(30,30,30,0.6));
            color: rgba(255,255,255,0.2);
            cursor: not-allowed;
            border-color: rgba(255,255,255,0.1);
            box-shadow: none;
        }

        /* –ú–û–î–ê–õ–ö–ê */
        #modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        #modal.show {
            display: flex;
        }

        .modal-box {
            background: linear-gradient(135deg, #1e293b, #0f172a);
            border: 4px solid rgba(255,215,0,0.4);
            border-radius: 30px;
            padding: 50px;
            max-width: 900px;
            width: 100%;
            text-align: center;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            backdrop-filter: blur(20px);
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: rgba(255,255,255,0.1);
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            color: #fff;
            font-size: 2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .close-btn:hover {
            background: rgba(239,68,68,0.3);
            border-color: #ef4444;
            transform: rotate(90deg);
        }

        .modal-pts {
            font-size: 5rem;
            font-weight: 900;
            color: #ffd700;
            margin-bottom: 25px;
            text-shadow: 0 0 30px rgba(255,215,0,0.6);
        }

        .timer {
            font-size: 4rem;
            font-weight: 900;
            color: #4ade80;
            margin-bottom: 25px;
            text-shadow: 0 0 20px rgba(74,222,128,0.5);
        }

        .timer.warning { 
            color: #fbbf24; 
            text-shadow: 0 0 20px rgba(251,191,36,0.5);
        }
        
        .timer.danger { 
            color: #ef4444; 
            text-shadow: 0 0 20px rgba(239,68,68,0.5);
            animation: blink 0.5s infinite; 
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        .question {
            font-size: 2rem;
            margin-bottom: 35px;
            line-height: 1.6;
            color: #e2e8f0;
        }

        .buzz-btn {
            width: 200px;
            height: 200px;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border: 6px solid #ffd700;
            border-radius: 50%;
            font-size: 1.4rem;
            font-weight: 900;
            color: #fff;
            cursor: pointer;
            margin: 25px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            box-shadow: 0 15px 50px rgba(239,68,68,0.5);
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .buzz-btn:hover:not(.disabled) {
            transform: scale(1.12);
            box-shadow: 0 20px 60px rgba(239,68,68,0.7);
        }

        .buzz-btn:active:not(.disabled) {
            transform: scale(1.05);
        }

        .buzz-btn.disabled {
            background: linear-gradient(135deg, rgba(100,100,100,0.5), rgba(70,70,70,0.5));
            border-color: rgba(255,255,255,0.2);
            cursor: not-allowed;
            box-shadow: none;
        }

        .answer-input {
            width: 100%;
            max-width: 550px;
            padding: 22px 30px;
            font-size: 1.6rem;
            text-align: center;
            background: rgba(255,255,255,0.1);
            border: 4px solid #ffd700;
            border-radius: 20px;
            color: #fff;
            margin-bottom: 20px;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .answer-input:focus {
            outline: none;
            border-color: #22c55e;
            box-shadow: 0 0 30px rgba(34,197,94,0.5);
        }

        .result {
            font-size: 2.5rem;
            font-weight: 900;
            padding: 25px;
            border-radius: 20px;
            margin: 25px 0;
        }

        .result.correct {
            background: rgba(34,197,94,0.3);
            border: 4px solid #22c55e;
            color: #22c55e;
            text-shadow: 0 0 20px rgba(34,197,94,0.5);
        }

        .result.wrong {
            background: rgba(239,68,68,0.3);
            border: 4px solid #ef4444;
            color: #ef4444;
            text-shadow: 0 0 20px rgba(239,68,68,0.5);
        }

        .hidden { display: none !important; }

        .admin-btn {
            position: fixed;
            bottom: 25px;
            right: 25px;
            width: 70px;
            height: 70px;
            background: rgba(255,255,255,0.1);
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            color: #fff;
            font-size: 2rem;
            cursor: pointer;
            z-index: 9996;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .admin-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: rotate(180deg);
        }

        @media (max-width: 768px) {
            h1 { font-size: 2.5rem; }
            h2 { font-size: 1.2rem; }
            .board { gap: 6px; }
            .category { font-size: 0.7rem; padding: 12px 6px; min-height: 70px; }
            .cell { padding: 20px; font-size: 1.4rem; }
            .modal-box { padding: 35px 20px; }
            .modal-pts { font-size: 3.5rem; }
            .timer { font-size: 3rem; }
            .question { font-size: 1.4rem; }
            .buzz-btn { width: 160px; height: 160px; font-size: 1.1rem; }
            .team-card { min-width: 130px; padding: 15px 20px; }
            .team-score { font-size: 2rem; }
        }
    </style>
</head>
<body>
    <!-- –î–µ–¥ –ú–æ—Ä–æ–∑ -->
    <div class="santa">üéÖüõ∑</div>

    <!-- –ì–∏—Ä–ª—è–Ω–¥–∞ -->
    <div class="garland" id="garland"></div>
    
    <!-- –°–Ω–µ–∂–∏–Ω–∫–∏ -->
    <div class="snowflakes" id="snowflakes"></div>

    <!-- –ê–¥–º–∏–Ω -->
    <button class="admin-btn" onclick="adminReset()">‚öôÔ∏è</button>

    <!-- –õ–û–ë–ë–ò -->
    <div id="lobby" class="container">
        <h1>üéÑ INQUIZ üéÑ</h1>
        <h2>V√°noƒçn√≠ Speci√°l ‚ùÑÔ∏è</h2>
        
        <input type="text" id="teamInput" class="input-field" placeholder="N√°zev t√Ωmu..." maxlength="20">
        <br>
        <button class="btn btn-green" onclick="addTeam()">‚ûï P≈ôidat t√Ωm</button>
        
        <div class="teams-list">
            <div class="teams-title">T√Ωmy v lobby:</div>
            <div id="teamsList"></div>
        </div>
        
        <input type="password" id="passInput" class="input-field" placeholder="Heslo: 6952" maxlength="4" style="width: 250px; letter-spacing: 5px;">
        <br>
        <button class="btn btn-red" onclick="startGame()">üöÄ ZAƒå√çT HRU</button>
        <br>
        <button class="btn btn-gray" onclick="clearAll()">üóëÔ∏è Vymazat v≈°e</button>
    </div>

    <!-- –ò–ì–†–ê -->
    <div id="game" class="container">
        <h1>üéÑ INQUIZ üéÑ</h1>
        
        <div id="infoBanner" class="info-banner"></div>
        <div id="scoreboard" class="scoreboard"></div>
        <div id="board" class="board"></div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê -->
    <div id="modal">
        <div class="modal-box">
            <div class="close-btn" onclick="closeQuestion()">‚úï</div>
            <div class="modal-pts" id="modalPts"></div>
            <div class="timer" id="timer">20</div>
            <div class="question" id="question"></div>
            
            <div id="answeringInfo" class="hidden" style="font-size: 1.4rem; color: rgba(255,255,255,0.8); margin-bottom: 20px;">
                Odpov√≠d√°: <strong id="answeringTeam" style="color: #ffd700; font-size: 1.6rem;"></strong>
            </div>
            
            <button class="buzz-btn" id="buzzBtn" onclick="buzzClick()">
                üîî<br>ODPOVƒöDƒöT
            </button>
            
            <div id="answerSection" class="hidden">
                <input type="text" id="answerInput" class="answer-input" placeholder="Va≈°e odpovƒõƒè...">
                <br>
                <button class="btn btn-green" onclick="submitAnswer()">Odeslat odpovƒõƒè</button>
            </div>
            
            <div id="result" class="result hidden"></div>
            <div id="correctAnswer" class="hidden" style="margin-top: 25px; padding: 20px; background: rgba(74,222,128,0.2); border: 3px solid #4ade80; border-radius: 15px; color: #4ade80; font-size: 1.4rem; font-weight: 700;"></div>
        </div>
    </div>

    <script>
        // Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDwo2GKOXEDDs31kRfFCQLy_TcXRC2DF0",
            authDomain: "inquiz-a82e2.firebaseapp.com",
            databaseURL: "https://inquiz-a82e2-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "inquiz-a82e2",
            storageBucket: "inquiz-a82e2.firebasestorage.app",
            messagingSenderId: "943129879818",
            appId: "1:943129879818:web:366e32fe072182cd0d86f3"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref('game4');

        // –ö–†–£–¢–´–ï –í–û–ü–†–û–°–´
        const Q = {
            1: {
                "TikTok & Trendy üî•": [
                    {q: "Kter√© zv√≠≈ôe se stalo symbolem 'Skibidi'?", a: ["z√°chod", "toilet", "wc"]},
                    {q: "Co znamen√° 'rizz'?", a: ["charisma", "charizmatick√Ω", "p≈ôita≈ælivost"]},
                    {q: "Kdo je popul√°rn√≠ streamer s maskami?", a: ["dream"]},
                    {q: "Trend kde stoj√≠≈° jako socha?", a: ["mannequin challenge"]},
                    {q: "Aplikace s 60s videi?", a: ["tiktok"]}
                ],
                "Gaming Legends üéÆ": [
                    {q: "Survival hra s ƒçerven√Ωmi a ≈ælut√Ωmi d≈ôevy?", a: ["minecraft"]},
                    {q: "Battle royale kde stav√≠≈°?", a: ["fortnite"]},
                    {q: "Hra kde jsi Among Us?", a: ["among us", "impostor"]},
                    {q: "Nejpopul√°rnƒõj≈°√≠ FPS s AK-47?", a: ["cs", "csgo", "cs2", "counter-strike"]},
                    {q: "Hra s Creepery a TNT?", a: ["minecraft"]}
                ],
                "Sigma Males üí™": [
                    {q: "Co je 'sigma grindset'?", a: ["mindset", "zp≈Øsob ≈æivota", "mentalita"]},
                    {q: "Fitness influencer 'Liver King'?", a: ["brian johnson", "liver king"]},
                    {q: "Meme 'Can you feel my...'?", a: ["heart"]},
                    {q: "Co znamen√° 'mewing'?", a: ["ƒçelist", "tongue posture", "jazyk"]},
                    {q: "Famous cit√°t: 'It's about...'?", a: ["drive", "power"]}
                ],
                "Meme Culture üòÇ": [
                    {q: "Pes meme 'wow such...'?", a: ["doge", "shiba"]},
                    {q: "≈Ω√°ba kter√° k≈ôiƒç√≠ 'AAAAA'?", a: ["pepe"]},
                    {q: "Meme s hudbou Rick Astley?", a: ["rickroll", "never gonna give you up"]},
                    {q: "B√≠l√° koƒçka co k≈ôiƒç√≠ na ≈æenu?", a: ["woman yelling at cat"]},
                    {q: "SpongeBob kdy≈æ je...'?", a: ["mocking", "sarcastic"]}
                ],
                "V√°noce & Zima üéÑ": [
                    {q: "Sob Santy s ƒçerven√Ωm nosem?", a: ["rudolf"]},
                    {q: "Film 'S√°m doma' hlavn√≠ postava?", a: ["kevin"]},
                    {q: "Kolik renti√©r≈Ø m√° Santa?", a: ["9", "devƒõt"]},
                    {q: "V√°noƒçn√≠ n√°poj s vaj√≠ƒçky?", a: ["eggnog"]},
                    {q: "Datum ≈†tƒõdr√©ho dne?", a: ["24", "24 prosinec", "24. prosince"]}
                ]
            }
        };

        const PTS = [200, 400, 600, 800, 1000];

        // State
        let game = {};
        let myTeam = localStorage.getItem('myTeam4') || '';
        let timer = null;

        // Init
        db.on('value', s => {
            const data = s.val();
            if (data) {
                game = data;
                render();
            }
        });

        function save() {
            db.set(game);
        }

        function render() {
            if (!game.started) {
                document.getElementById('lobby').style.display = 'block';
                document.getElementById('game').style.display = 'none';
                document.getElementById('modal').classList.remove('show');
                renderTeamsList();
            } else {
                document.getElementById('lobby').style.display = 'none';
                document.getElementById('game').style.display = 'block';
                renderScoreboard();
                renderBoard();
                
                if (game.current) {
                    showModal();
                } else {
                    document.getElementById('modal').classList.remove('show');
                    stopTimer();
                }
            }
        }

        // –õ–û–ë–ë–ò
        function renderTeamsList() {
            const list = document.getElementById('teamsList');
            if (!game.teams || game.teams.length === 0) {
                list.innerHTML = '<div style="color: rgba(255,255,255,0.5); font-size: 1.2rem;">Zat√≠m ≈æ√°dn√© t√Ωmy...</div>';
                return;
            }
            list.innerHTML = game.teams.map((t, i) => 
                `<div class="team-item">${i+1}. ${t.name} <span style="float: right;">${t.score} bod≈Ø</span></div>`
            ).join('');
        }

        function addTeam() {
            const input = document.getElementById('teamInput');
            const name = input.value.trim();
            if (!name) return alert('Zadejte n√°zev t√Ωmu!');
            
            if (!game.teams) game.teams = [];
            if (game.teams.some(t => t.name === name)) return alert('T√Ωm u≈æ existuje!');
            
            game.teams.push({name, score: 0});
            myTeam = name;
            localStorage.setItem('myTeam4', name);
            input.value = '';
            save();
        }

        function clearAll() {
            const pass = prompt('Heslo:');
            if (pass !== '6952') return alert('≈†patn√© heslo!');
            game = {started: false, teams: [], used: []};
            myTeam = '';
            localStorage.removeItem('myTeam4');
            save();
        }

        function startGame() {
            const pass = document.getElementById('passInput').value;
            if (pass !== '6952') return alert('≈†patn√© heslo!');
            if (!game.teams || game.teams.length === 0) return alert('P≈ôidejte alespo≈à jeden t√Ωm!');
            
            game.started = true;
            game.round = 1;
            game.used = [];
            game.current = null;
            game.activeTeam = Math.floor(Math.random() * game.teams.length);
            save();
        }

        // –ò–ì–†–ê
        function renderScoreboard() {
            const sb = document.getElementById('scoreboard');
            sb.innerHTML = game.teams.map((t, i) => {
                let cls = 'team-card';
                if (game.activeTeam === i && !game.current) cls += ' active';
                if (game.answering === i) cls += ' answering';
                return `<div class="${cls}">
                    <div class="team-name">${t.name}</div>
                    <div class="team-score">${t.score}</div>
                </div>`;
            }).join('');

            const info = document.getElementById('infoBanner');
            if (game.activeTeam !== null && !game.current) {
                info.style.display = 'block';
                info.innerHTML = `<strong>${game.teams[game.activeTeam].name}</strong> vyb√≠r√° ot√°zku üëÜ`;
            } else {
                info.style.display = 'none';
            }
        }

        function renderBoard() {
            const cats = Object.keys(Q[game.round || 1]);
            let html = cats.map(c => `<div class="category">${c}</div>`).join('');
            
            PTS.forEach((pts, row) => {
                cats.forEach((cat, col) => {
                    const id = `${game.round}-${col}-${row}`;
                    const used = game.used && game.used.includes(id);
                    html += `<div class="cell ${used ? 'used' : ''}" onclick="openQ('${cat}', ${row})">${pts}</div>`;
                });
            });
            
            document.getElementById('board').innerHTML = html;
        }

        // –í–û–ü–†–û–°
        function openQ(cat, idx) {
            if (game.current) return;
            
            const cats = Object.keys(Q[game.round]);
            const catIdx = cats.indexOf(cat);
            const id = `${game.round}-${catIdx}-${idx}`;
            
            if (game.used && game.used.includes(id)) return;
            
            const myIdx = game.teams.findIndex(t => t.name === myTeam);
            if (game.activeTeam !== null && myIdx !== game.activeTeam) {
                return alert('Nen√≠ va≈°e ≈ôada vyb√≠rat!');
            }
            
            const q = Q[game.round][cat][idx];
            game.current = {
                id,
                pts: PTS[idx],
                q: q.q,
                a: q.a
            };
            game.answering = null;
            game.tried = [];
            game.timerStart = Date.now();
            save();
        }

        function showModal() {
            document.getElementById('modalPts').textContent = game.current.pts;
            document.getElementById('question').textContent = game.current.q;
            document.getElementById('result').className = 'result hidden';
            document.getElementById('correctAnswer').className = 'hidden';
            document.getElementById('answerInput').value = '';
            
            updateBuzzState();
            document.getElementById('modal').classList.add('show');
            startTimer();
        }

        function updateBuzzState() {
            const myIdx = game.teams.findIndex(t => t.name === myTeam);
            const buzzBtn = document.getElementById('buzzBtn');
            const answerSection = document.getElementById('answerSection');
            const info = document.getElementById('answeringInfo');
            
            if (game.answering !== null && game.answering !== undefined) {
                buzzBtn.classList.add('disabled');
                info.classList.remove('hidden');
                document.getElementById('answeringTeam').textContent = game.teams[game.answering].name;
                
                if (game.answering === myIdx) {
                    answerSection.classList.remove('hidden');
                    setTimeout(() => document.getElementById('answerInput').focus(), 100);
                } else {
                    answerSection.classList.add('hidden');
                }
            } else {
                info.classList.add('hidden');
                answerSection.classList.add('hidden');
                
                if (myIdx === -1 || (game.tried && game.tried.includes(myIdx))) {
                    buzzBtn.classList.add('disabled');
                } else {
                    buzzBtn.classList.remove('disabled');
                }
            }
        }

        function buzzClick() {
            const myIdx = game.teams.findIndex(t => t.name === myTeam);
            if (myIdx === -1) return alert('Nejste v ≈æ√°dn√©m t√Ωmu!');
            if (game.answering !== null && game.answering !== undefined) return;
            if (game.tried && game.tried.includes(myIdx)) return;
            
            game.answering = myIdx;
            if (!game.tried) game.tried = [];
            game.tried.push(myIdx);
            save();
        }

        function submitAnswer() {
            const myIdx = game.teams.findIndex(t => t.name === myTeam);
            if (game.answering !== myIdx) return;
            
            const input = document.getElementById('answerInput').value.trim().toLowerCase();
            if (!input) return alert('Zadejte odpovƒõƒè!');
            
            const correct = game.current.a.some(a => {
                const ans = a.toLowerCase();
                return input === ans || input.includes(ans) || ans.includes(input);
            });
            
            const result = document.getElementById('result');
            
            if (correct) {
                result.textContent = '‚úÖ SPR√ÅVNƒö!';
                result.className = 'result correct';
                game.teams[myIdx].score += game.current.pts;
                game.activeTeam = myIdx;
                
                if (!game.used) game.used = [];
                game.used.push(game.current.id);
                save();
                
                setTimeout(() => {
                    game.current = null;
                    game.answering = null;
                    game.tried = [];
                    save();
                }, 2000);
            } else {
                result.textContent = '‚ùå ≈†PATNƒö!';
                result.className = 'result wrong';
                game.teams[myIdx].score -= game.current.pts;
                game.answering = null;
                game.timerStart = Date.now();
                save();
                
                setTimeout(() => {
                    result.className = 'result hidden';
                    if (game.tried && game.tried.length >= game.teams.length) {
                        showCorrect();
                    }
                }, 1500);
            }
        }

        function showCorrect() {
            stopTimer();
            document.getElementById('buzzBtn').classList.add('disabled');
            document.getElementById('answerSection').classList.add('hidden');
            
            const ca = document.getElementById('correctAnswer');
            ca.textContent = '‚úÖ Spr√°vn√° odpovƒõƒè: ' + game.current.a[0];
            ca.classList.remove('hidden');
            
            if (!game.used) game.used = [];
            game.used.push(game.current.id);
            save();
            
            setTimeout(() => {
                game.current = null;
                game.answering = null;
                game.tried = [];
                save();
            }, 3000);
        }

        function closeQuestion() {
            const pass = prompt('Heslo pro zav≈ôen√≠:');
            if (pass !== '6952') return alert('≈†patn√© heslo!');
            
            if (game.current) {
                if (!game.used) game.used = [];
                game.used.push(game.current.id);
            }
            game.current = null;
            game.answering = null;
            game.tried = [];
            save();
        }

        // –¢–ê–ô–ú–ï–†
        function startTimer() {
            stopTimer();
            timer = setInterval(updateTimer, 100);
        }

        function updateTimer() {
            if (!game.timerStart || !game.current) return;
            
            const elapsed = Math.floor((Date.now() - game.timerStart) / 1000);
            const remaining = Math.max(0, 20 - elapsed);
            
            const t = document.getElementById('timer');
            t.textContent = remaining;
            t.className = 'timer';
            if (remaining <= 5) t.className = 'timer danger';
            else if (remaining <= 10) t.className = 'timer warning';
            
            if (remaining <= 0) showCorrect();
        }

        function stopTimer() {
            if (timer) clearInterval(timer);
        }

        // –ê–î–ú–ò–ù
        function adminReset() {
            const pass = prompt('Admin heslo:');
            if (pass !== '6952') return alert('≈†patn√© heslo!');
            
            const cmd = prompt('P≈ô√≠kazy:\nreset - √∫pln√Ω reset\nlobby - zpƒõt do lobby\nscores - upravit body');
            
            if (cmd === 'reset') {
                game = {started: false, teams: [], used: []};
                myTeam = '';
                localStorage.removeItem('myTeam4');
                save();
            } else if (cmd === 'lobby') {
                game.started = false;
                game.current = null;
                save();
            } else if (cmd === 'scores') {
                const teamName = prompt('N√°zev t√Ωmu:');
                const team = game.teams.find(t => t.name.toLowerCase() === teamName.toLowerCase());
                if (!team) return alert('T√Ωm nenalezen!');
                const newScore = prompt('Nov√© body:', team.score);
                if (newScore !== null) {
                    team.score = parseInt(newScore) || 0;
                    save();
                }
            }
        }

        // Dekorace
        function createGarland() {
            const g = document.getElementById('garland');
            for (let i = 0; i < 40; i++) {
                g.innerHTML += '<div class="light"></div>';
            }
        }

        function createSnowflakes() {
            const s = document.getElementById('snowflakes');
            const flakes = ['‚ùÑ', '‚ùÖ', '‚ùÜ', '‚úª', '‚úº', '‚ùâ'];
            for (let i = 0; i < 50; i++) {
                const f = document.createElement('div');
                f.className = 'snowflake';
                f.innerHTML = flakes[Math.floor(Math.random() * flakes.length)];
                f.style.left = Math.random() * 100 + '%';
                f.style.animationDuration = (3 + Math.random() * 5) + 's';
                f.style.animationDelay = Math.random() * 5 + 's';
                f.style.fontSize = (10 + Math.random() * 15) + 'px';
                s.appendChild(f);
            }
        }

        // Enter
        document.getElementById('teamInput').addEventListener('keypress', e => {
            if (e.key === 'Enter') addTeam();
        });
        document.getElementById('answerInput').addEventListener('keypress', e => {
            if (e.key === 'Enter') submitAnswer();
        });

        // –°—Ç–∞—Ä—Ç
        createGarland();
        createSnowflakes();
    </script>
</body>
</html>
